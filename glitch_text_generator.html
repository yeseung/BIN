<!--
File name example (English): glitch_text_generator.html
ì˜ê³ (Zalgo) í…ìŠ¤íŠ¸ ìƒì„±ê¸° - Vanilla JS + ê¹”ë”í•œ CSS
- URL ê°™ì€ í…ìŠ¤íŠ¸ê°€ "ê¹¨ì ¸ë³´ì´ë©´ì„œë„" ì½íˆê²Œ í•˜ë ¤ê³ : ì˜ë¬¸/í•œê¸€ ê¸€ìì—ë§Œ ê²°í•©ë¬¸ì(Combining mark)ë¥¼ ë¶™ì´ê³ ,
  ìˆ«ì/ê¸°í˜¸(:// . ? & ë“±)ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ê±´ë“œë¦¬ì§€ ì•ŠìŠµë‹ˆë‹¤.
- ì¶œë ¥ì´ ê²¹ì³ ë³´ì´ëŠ” ë¬¸ì œë¥¼ ì¤„ì´ê¸° ìœ„í•´ line-heightë¥¼ ë„‰ë„‰íˆ ì¡ì•˜ìŠµë‹ˆë‹¤.
-->

<!doctype html>
<html lang="ko">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>ì˜ê³  í…ìŠ¤íŠ¸ ìƒì„±ê¸°</title>
    <style>
        :root{
            --bg:#f4f5f7;
            --card:#ffffff;
            --stroke:#e5e7eb;
            --text:#111827;
            --muted:#6b7280;
            --blue:#2563eb;
            --blue2:#1d4ed8;
            --radius:14px;
            --shadow: 0 18px 40px rgba(17,24,39,.08);
        }
        *{box-sizing:border-box}
        body{
            margin:0;
            font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans KR", Arial, sans-serif;
            background: var(--bg);
            color: var(--text);
        }
        .wrap{
            max-width: 1100px;
            margin: 0 auto;
            padding: 26px 16px 56px;
        }
        h1{
            margin: 6px 0 18px;
            font-size: 34px;
            font-weight: 900;
            letter-spacing: -.3px;
        }
        .card{
            background: var(--card);
            border:1px solid var(--stroke);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 16px;
            margin-top: 14px;
        }
        .row{
            display:flex;
            gap:14px;
            flex-wrap:wrap;
            align-items:flex-end;
        }
        .col{
            flex:1;
            min-width:260px;
        }
        label{
            display:block;
            font-weight: 900;
            margin: 0 0 8px;
            color:#111827;
        }
        textarea{
            width:100%;
            min-height: 240px;
            resize: vertical;
            border:1px solid var(--stroke);
            border-radius: 12px;
            padding: 14px;
            outline:none;
            font-size: 15px;
            line-height: 1.85; /* ê²¹ì¹¨ ë°©ì§€ í¬ì¸íŠ¸ */
            color: var(--text);
            background: #fbfbfc;
        }
        textarea:focus{
            border-color: rgba(37,99,235,.55);
            box-shadow: 0 0 0 4px rgba(37,99,235,.12);
            background:#fff;
        }
        .btn{
            border:0;
            border-radius: 12px;
            padding: 11px 14px;
            font-weight: 900;
            cursor:pointer;
            transition: transform .04s ease, filter .12s ease;
            user-select:none;
            display:inline-flex;
            align-items:center;
            gap:8px;
            white-space:nowrap;
        }
        .btn:active{ transform: translateY(1px); }
        .btn.primary{
            background: linear-gradient(135deg, var(--blue), var(--blue2));
            color:#fff;
        }
        .btn.gray{
            background: linear-gradient(135deg, #9ca3af, #6b7280);
            color:#fff;
        }
        .btn.green{
            background: linear-gradient(135deg, #10b981, #059669);
            color:#fff;
        }
        .btn.orange{
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color:#fff;
        }
        .help{
            margin-top:10px;
            color: var(--muted);
            font-size: 13px;
            line-height: 1.6;
        }
        .segmented{
            display:inline-flex;
            border:1px solid var(--stroke);
            border-radius: 12px;
            overflow:hidden;
            background:#fff;
        }
        .segmented button{
            border:0;
            background:transparent;
            padding: 10px 12px;
            font-weight: 900;
            cursor:pointer;
            color:#374151;
        }
        .segmented button.active{
            background: rgba(37,99,235,.10);
            color:#1d4ed8;
        }
        .control{
            display:flex;
            align-items:center;
            gap:10px;
            flex-wrap:wrap;
            margin-top: 8px;
        }
        .control small{ color:var(--muted); }
        input[type="range"]{ width: 240px; }
        .check{
            display:flex;
            align-items:center;
            gap:8px;
            margin-top: 10px;
            color:#374151;
            font-weight: 800;
        }
        .footerNote{
            margin-top: 12px;
            color:#6b7280;
            font-size: 13px;
            line-height: 1.7;
        }
    </style>
</head>

<body>
<div class="wrap">
    <h1>ì˜ê³  í…ìŠ¤íŠ¸ ìƒì„±ê¸°</h1>

    <div class="card">
        <label for="inputText">í…ìŠ¤íŠ¸ ì…ë ¥:</label>
        <textarea id="inputText" placeholder="ì—¬ê¸°ì— í…ìŠ¤íŠ¸ë¥¼ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”...&#10;ì˜ˆ) URL ëª©ë¡, ë¬¸ì¥ ë“±"></textarea>

        <div class="row" style="margin-top:12px;">
            <div class="col">
                <label style="margin-bottom:6px;">ê°•ë„</label>
                <div class="segmented" id="levelSeg" role="tablist" aria-label="ê°•ë„ ì„ íƒ">
                    <button type="button" class="active" data-level="light">Light</button>
                    <button type="button" data-level="medium">Medium</button>
                    <button type="button" data-level="heavy">Heavy</button>
                </div>

                <div class="control">
                    <span style="font-weight:900;">ëœë¤ë„</span>
                    <input id="randomness" type="range" min="0" max="100" value="60" />
                    <small id="randomnessLabel">60%</small>
                </div>

                <label class="check">
                    <input id="preservePunct" type="checkbox" checked />
                    ê¸°í˜¸/ìˆ«ì(:// . ? & ë“±)ëŠ” ê·¸ëŒ€ë¡œ ë‘ê¸° (URL ê°€ë…ì„± ìœ ì§€)
                </label>

                <label class="check">
                    <input id="oneLine" type="checkbox" />
                    í•œ ì¤„ë¡œ í•©ì¹˜ê¸° (ì¤„ë°”ê¿ˆ ì œê±°)
                </label>
            </div>

            <div class="col" style="text-align:right;">
                <button class="btn primary" id="btnGenerate">âš¡ ìƒì„±</button>
                <button class="btn green" id="btnCopy">ğŸ“‹ ë³µì‚¬</button>
                <button class="btn gray" id="btnClear">ğŸ—‘ï¸ ë¹„ìš°ê¸°</button>
                <button class="btn orange" id="btnRegenerate">ğŸ² ë‹¤ì‹œ ìƒì„±</button>

                <div class="help" style="text-align:left;">
                    â€¢ â€œë‹¤ì‹œ ìƒì„±â€ì€ ê°™ì€ ì…ë ¥ìœ¼ë¡œ ê¸€ë¦¬ì¹˜ë§Œ ë‹¤ì‹œ ëœë¤í•˜ê²Œ ë½‘ìŠµë‹ˆë‹¤.<br>
                    â€¢ ì¶œë ¥ì´ ë„ˆë¬´ ë‚œì¡í•˜ë©´ ê°•ë„ë¥¼ Lightë¡œ ë‚®ì¶”ê±°ë‚˜ ëœë¤ë„ë¥¼ ì¤„ì—¬ë³´ì„¸ìš”.
                </div>
            </div>
        </div>
    </div>

    <div class="card">
        <label for="outputText">ì˜ê³  í…ìŠ¤íŠ¸:</label>
        <textarea id="outputText" readonly placeholder="ìƒì„± ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤."></textarea>

        <div class="footerNote">
            ì˜ê³ (Zalgo) í…ìŠ¤íŠ¸ëŠ” ìœ ë‹ˆì½”ë“œ â€œê²°í•© ë¬¸ì(Combining Marks)â€ë¥¼ í™œìš©í•©ë‹ˆë‹¤. ì¼ë¶€ ì•±/í°íŠ¸ì—ì„œ ì¤„ ê°„ê²©ì´ ë‹¬ë¼ ë³´ì¼ ìˆ˜ ìˆì–´ìš”.
        </div>
    </div>
</div>

<script>
    // -----------------------------
    // Zalgo combining mark pools
    // (ë„ˆë¬´ ê³¼í•˜ê²Œ ë„£ìœ¼ë©´ ê²¹ì¹˜ê³  ëŠë ¤ì ¸ì„œ, ì ë‹¹í•œ ë²”ìœ„ë§Œ ì‚¬ìš©)
    // -----------------------------
    const COMBINING_UP = [
        "\u030d","\u030e","\u0304","\u0305","\u033f","\u0311","\u0306","\u0310",
        "\u0352","\u0357","\u0351","\u0307","\u0308","\u030a","\u0342","\u0343",
        "\u0344","\u034a","\u034b","\u034c","\u0303","\u0302","\u030c","\u0350",
        "\u0300","\u0301","\u030b","\u030f","\u0312","\u0313","\u0314","\u033d",
        "\u0309","\u0363","\u0364","\u0365","\u0366","\u0367","\u0368","\u0369",
        "\u036a","\u036b","\u036c","\u036d","\u036e","\u036f"
    ];
    const COMBINING_MID = [
        "\u0334","\u0335","\u0336","\u0337","\u0338","\u034f","\u035c","\u035d",
        "\u035e","\u035f","\u0360","\u0362"
    ];
    const COMBINING_DOWN = [
        "\u0316","\u0317","\u0318","\u0319","\u031c","\u031d","\u031e","\u031f",
        "\u0320","\u0324","\u0325","\u0326","\u0329","\u032a","\u032b","\u032c",
        "\u032d","\u032e","\u032f","\u0330","\u0331","\u0332","\u0333","\u0339",
        "\u033a","\u033b","\u033c","\u0345","\u0347","\u0348","\u0349","\u034d",
        "\u034e","\u0353","\u0354","\u0355","\u0356","\u0359","\u035a","\u0323"
    ];

    // ê°•ë„ë³„ ìµœëŒ€ ê²°í•©ë¬¸ì ê°œìˆ˜(ëŒ€ëµ)
    const LEVELS = {
        light:  { up: 2, mid: 1, down: 2 },
        medium: { up: 6, mid: 2, down: 6 },
        heavy:  { up: 12, mid: 4, down: 12 }
    };

    // -----------------------------
    // Helpers
    // -----------------------------
    const $ = (id) => document.getElementById(id);

    function randInt(min, max){
        return Math.floor(Math.random() * (max - min + 1)) + min;
    }
    function pick(arr){
        return arr[Math.floor(Math.random() * arr.length)];
    }

    // ê¸€ë¦¬ì¹˜ ì ìš© ëŒ€ìƒ ë¬¸ì íŒì •:
    // - ê¸°ë³¸: ì˜ë¬¸/í•œê¸€/ê¸°ë³¸ ë¼í‹´(ê°€ë…ì„± ìœ ì§€)
    // - preservePunct ì²´í¬ ì‹œ ìˆ«ì/ê¸°í˜¸ì—ëŠ” ì ìš© ì•ˆ í•¨
    function isGlitchTarget(ch, preservePunct){
        if (ch === "\n" || ch === "\r" || ch === "\t" || ch === " ") return false;

        // í•œê¸€/ì˜ë¬¸
        const code = ch.codePointAt(0);

        const isHangul = (code >= 0xAC00 && code <= 0xD7A3);
        const isLatin  = (
            (code >= 0x41 && code <= 0x5A) || // A-Z
            (code >= 0x61 && code <= 0x7A)    // a-z
        );

        if (preservePunct){
            // ìˆ«ì/ê¸°í˜¸ ì œì™¸ â†’ ê¸€ì(í•œê¸€/ì˜ë¬¸)ë§Œ
            return isHangul || isLatin;
        }

        // preservePunct í•´ì œ: ì›¬ë§Œí•œ ë¬¸ìì— ì ìš©(ë„ˆë¬´ ë¬´ì„œì›Œì„œ ì œì–´ë¬¸ìëŠ” ì œì™¸)
        if (code < 0x20) return false;
        return true;
    }

    // randomness(0~100) ë¹„ìœ¨ë§Œí¼ë§Œ ê¸€ë¦¬ì¹˜ ì ìš©
    function shouldGlitch(randomness){
        return Math.random() * 100 < randomness;
    }

    function zalgoChar(ch, level, randomness, preservePunct){
        if (!isGlitchTarget(ch, preservePunct)) return ch;
        if (!shouldGlitch(randomness)) return ch;

        const lim = LEVELS[level] || LEVELS.light;

        const upCount   = randInt(0, lim.up);
        const midCount  = randInt(0, lim.mid);
        const downCount = randInt(0, lim.down);

        let out = ch;

        for (let i=0; i<upCount; i++) out += pick(COMBINING_UP);
        for (let i=0; i<midCount; i++) out += pick(COMBINING_MID);
        for (let i=0; i<downCount; i++) out += pick(COMBINING_DOWN);

        return out;
    }

    function zalgoText(text, level, randomness, preservePunct){
        let result = "";
        // for..ofëŠ” ìœ ë‹ˆì½”ë“œ ì½”ë“œí¬ì¸íŠ¸ ë‹¨ìœ„ë¡œ ìˆœíšŒ
        for (const ch of text){
            result += zalgoChar(ch, level, randomness, preservePunct);
        }
        return result;
    }

    // -----------------------------
    // UI State
    // -----------------------------
    let currentLevel = "light";
    let lastInput = "";
    let lastOutput = "";

    function setLevel(level){
        currentLevel = level;
        const buttons = $("levelSeg").querySelectorAll("button");
        buttons.forEach(b => b.classList.toggle("active", b.dataset.level === level));
    }

    // -----------------------------
    // Actions
    // -----------------------------
    function generate(){
        const input = $("inputText").value || "";
        const preservePunct = $("preservePunct").checked;
        const oneLine = $("oneLine").checked;
        const randomness = Number($("randomness").value || 0);

        if (!input.trim()){
            $("outputText").value = "";
            lastInput = "";
            lastOutput = "";
            return;
        }

        let src = input;
        if (oneLine){
            src = src.replace(/\r?\n+/g, " ").replace(/\s{2,}/g, " ").trim();
        }

        const out = zalgoText(src, currentLevel, randomness, preservePunct);

        $("outputText").value = out;
        lastInput = input;
        lastOutput = out;
    }

    function regenerate(){
        // ê°™ì€ ì…ë ¥ìœ¼ë¡œ ëœë¤ë§Œ ë‹¤ì‹œ
        if (!$("inputText").value.trim()) return;
        generate();
    }

    async function copyOutput(){
        const out = $("outputText").value;
        if (!out) return;
        try{
            await navigator.clipboard.writeText(out);
            toast("ë³µì‚¬í–ˆìŠµë‹ˆë‹¤!");
        }catch(e){
            // fallback
            $("outputText").focus();
            $("outputText").select();
            document.execCommand("copy");
            toast("ë³µì‚¬í–ˆìŠµë‹ˆë‹¤!");
        }
    }

    function clearAll(){
        $("inputText").value = "";
        $("outputText").value = "";
        lastInput = "";
        lastOutput = "";
    }

    // ë¯¸ë‹ˆ í† ìŠ¤íŠ¸
    let toastTimer = null;
    function toast(msg){
        let el = document.getElementById("toast");
        if (!el){
            el = document.createElement("div");
            el.id = "toast";
            el.style.position = "fixed";
            el.style.left = "50%";
            el.style.bottom = "22px";
            el.style.transform = "translateX(-50%)";
            el.style.padding = "10px 12px";
            el.style.borderRadius = "12px";
            el.style.background = "rgba(17,24,39,.92)";
            el.style.color = "#fff";
            el.style.fontWeight = "900";
            el.style.boxShadow = "0 12px 30px rgba(0,0,0,.20)";
            el.style.zIndex = 9999;
            el.style.opacity = "0";
            el.style.transition = "opacity .15s ease";
            document.body.appendChild(el);
        }
        el.textContent = msg;
        el.style.opacity = "1";
        clearTimeout(toastTimer);
        toastTimer = setTimeout(()=> el.style.opacity="0", 1400);
    }

    // -----------------------------
    // Events
    // -----------------------------
    document.addEventListener("DOMContentLoaded", () => {
        // segmented
        $("levelSeg").addEventListener("click", (e) => {
            const btn = e.target.closest("button");
            if (!btn) return;
            setLevel(btn.dataset.level);
        });

        $("randomness").addEventListener("input", () => {
            $("randomnessLabel").textContent = $("randomness").value + "%";
        });

        $("btnGenerate").addEventListener("click", generate);
        $("btnRegenerate").addEventListener("click", regenerate);
        $("btnCopy").addEventListener("click", copyOutput);
        $("btnClear").addEventListener("click", clearAll);

        // Ctrl/Cmd + Enter = ìƒì„±
        $("inputText").addEventListener("keydown", (e) => {
            const isMac = navigator.platform.toUpperCase().includes("MAC");
            if ((isMac ? e.metaKey : e.ctrlKey) && e.key === "Enter"){
                e.preventDefault();
                generate();
            }
        });
    });
</script>
</body>
</html>
