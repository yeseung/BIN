<!doctype html>
<html lang="ko">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
    <title>í•œê¸€ ë¡œë ˜ ì…ìˆ¨ ìƒì„±ê¸°</title>
    <style>
        :root{
            --bg:#f6f8fb;
            --panel:#fff;
            --text:#0f172a;
            --muted:#64748b;
            --line:#e5e7eb;
            --primary:#2563eb;
            --shadow:0 18px 55px rgba(15,23,42,.12);
            --shadow2:0 10px 30px rgba(15,23,42,.10);
            --radius:18px;
        }
        *{ box-sizing:border-box; }
        body{
            margin:0;
            font-family: system-ui,-apple-system,"Segoe UI",Roboto,"Noto Sans KR",Arial,sans-serif;
            background:var(--bg);
            color:var(--text);
        }
        .wrap{ width:min(980px, calc(100% - 28px)); margin:18px auto 48px; }

        .quiz_title_box{
            display:flex; align-items:center; gap:10px;
            padding:14px 16px; background:var(--panel);
            border:1px solid var(--line);
            border-radius:999px; box-shadow:var(--shadow2);
        }
        .backlist{
            display:inline-grid; place-items:center;
            width:38px; height:38px; border-radius:999px;
            border:1px solid var(--line); background:#fff;
            cursor:pointer; user-select:none;
        }
        .backlist:active{ transform: translateY(1px); }
        .quiz_title{ font-size:20px; font-weight:1000; letter-spacing:-.2px; }
        .quiz_doc{ margin:14px 2px; color:var(--muted); line-height:1.6; font-weight:600; }

        .card{
            background:var(--panel);
            border:1px solid var(--line);
            border-radius:var(--radius);
            box-shadow:var(--shadow);
            padding:16px;
            margin-top:12px;
        }

        .grid{
            display:grid;
            grid-template-columns: repeat(3, minmax(0, 1fr));
            gap:12px;
        }
        @media (max-width: 760px){
            .grid{ grid-template-columns: 1fr; }
        }

        label{ display:block; font-weight:900; margin-bottom:6px; }
        select{
            width:100%;
            padding:12px 12px;
            border-radius:14px;
            border:1px solid var(--line);
            background:#fff;
            font-weight:800;
            outline:none;
        }
        select:focus{ border-color:#cbd5e1; box-shadow:0 0 0 4px rgba(37,99,235,.10); }

        .btnrow{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; margin-top:10px; }
        .btn{
            border:0;
            padding:10px 14px;
            border-radius:999px;
            font-weight:1000;
            cursor:pointer;
            box-shadow:0 10px 22px rgba(15,23,42,.14);
            display:inline-flex; align-items:center; gap:8px;
        }
        .btn.primary{ background:var(--primary); color:#fff; }
        .btn.gray{ background:#0f172a; color:#fff; }
        .btn.soft{ background:#f1f5f9; color:#0f172a; box-shadow:none; border:1px solid var(--line); }
        .btn:active{ transform: translateY(1px); }

        .status{
            margin-left:auto;
            color:var(--muted);
            font-weight:900;
            display:flex; align-items:center; gap:8px;
        }
        .dot{
            width:10px; height:10px; border-radius:999px; background:#cbd5e1;
        }
        .dot.loading{ background:#f59e0b; box-shadow:0 0 0 4px rgba(245,158,11,.15); }

        .resultWrap{ margin-top:12px; }
        .result{
            border:1px solid var(--line);
            border-radius:16px;
            background:#fff;
            padding:14px;
            line-height:1.8;
            font-weight:700;
            color:#111827;
            white-space: pre-wrap;
            word-break: break-word;
            min-height: 140px;
        }
        .hint{
            margin-top:10px;
            color:var(--muted);
            font-weight:700;
        }
        .help_title{ margin-top:22px; font-weight:1000; }
        .help_doc{
            margin-top:6px;
            background:#f8fafc;
            border:1px solid var(--line);
            border-radius:14px;
            padding:12px;
            color:var(--muted);
            font-weight:700;
            line-height:1.7;
        }

        /* ê²°ê³¼ ì˜ì—­ì— í•œê¸€ ë¡œë ˜ ëŠë‚Œì„ ì£¼ê³  ì‹¶ë‹¤ë©´ */
        .hangul_ipsum{ letter-spacing: .1px; }
    </style>
</head>

<body>
<div class="wrap">

    <div class="quiz_title_box">
        <span class="backlist" id="btnBack" title="ë’¤ë¡œ">â†</span>
        <div class="quiz_title">í•œê¸€ ë¡œë ˜ ì…ìˆ¨ ìƒì„±ê¸°</div>
    </div>

    <div class="quiz_doc">
        ë¡œë ˜ ì…ìˆ¨ì€ ì¶œíŒ, ë””ìì¸, ë˜ëŠ” ì›¹ ì‘ì—…ì—ì„œ ì‹œê°ì  ì—°ì¶œì„ ìœ„í•´ ì‚¬ìš©í•˜ëŠ” ì˜ë¯¸ ì—†ëŠ” ì±„ìš°ê¸°ìš© í…ìŠ¤íŠ¸ì…ë‹ˆë‹¤.
        ì´ì œ í•œê¸€ë¡œë„ ë¡œë ˜ ì…ìˆ¨ì„ ìƒì„±í•˜ì—¬ ìì—°ìŠ¤ëŸ¬ìš´ ë ˆì´ì•„ì›ƒ ì‹œë®¬ë ˆì´ì…˜ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.
    </div>

    <div class="card">
        <form id="ipsumForm" autocomplete="off">
            <div class="grid">
                <div>
                    <label for="text_line_count">ë¬¸ë‹¨ ìˆ˜</label>
                    <select id="text_line_count" name="text_line_count">
                        <!-- 1~30 -->
                    </select>
                </div>

                <div>
                    <label for="text_len">ê¸€ì ê¸¸ì´</label>
                    <select id="text_len" name="text_len">
                        <option value="shorter">ë”ì§§ê²Œ</option>
                        <option value="shot">ì§§ê²Œ</option>
                        <option value="middle">ì¤‘ê°„</option>
                        <option value="long">ê¸¸ê²Œ</option>
                        <option value="louder">ë”ê¸¸ê²Œ</option>
                    </select>
                </div>

                <div>
                    <label for="text_source">ì†ŒìŠ¤ ì„ íƒ</label>
                    <select id="text_source" name="text_source">
                        <option value="ëª¨ë°€ê½ƒ">ëª¨ë°€ê½ƒ í•„ ë¬´ë µ</option>
                        <option value="íƒœì¡°1ê¶Œ">ì¡°ì„ ì™•ì¡°ì‹¤ë¡ íƒœì¡°ì‹¤ë¡1ê¶Œ(í•œê¸€)</option>
                        <option value="íƒœì¡°1ê¶Œí•œì">ì¡°ì„ ì™•ì¡°ì‹¤ë¡ íƒœì¡°ì‹¤ë¡1ê¶Œ(í•œì)</option>
                        <option value="Prejudice">Pride and Prejudice(ì˜ë¬¸)</option>
                        <option value="ìš´ìˆ˜ì¢‹ì€ë‚ ">ìš´ìˆ˜ ì¢‹ì€ ë‚ </option>
                        <option value="ë´„ë´„">ë´„ë´„ ì¡°ê´‘</option>
                    </select>
                </div>
            </div>

            <div class="btnrow">
                <button type="button" class="btn primary" id="btnGenerate">â†» í•œê¸€ ë¡œë ˜ ì…ìˆ¨ ìƒì„±</button>
                <button type="button" class="btn soft" id="btnCopy">ğŸ“‹ ë³µì‚¬</button>
                <button type="button" class="btn gray" id="btnReload">ğŸ”„ ë‹¤ì‹œ</button>

                <div class="status">
                    <span class="dot" id="loadingDot"></span>
                    <span id="loadingText">ëŒ€ê¸°</span>
                </div>
            </div>
        </form>

        <div class="resultWrap">
            <div style="margin:12px 0 8px; font-weight:1000;">ê²°ê³¼</div>
            <div id="result" class="result hangul_ipsum"></div>
            <div class="hint">â€» ìƒì„±ì— ì•½ê°„ì˜ ì‹œê°„ì´ í•„ìš”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</div>
        </div>
    </div>

    <div style="margin-top:14px; color:var(--muted); font-weight:800;">í•œê¸€ ë”ë¯¸ê°’ ìƒì„±í•˜ê¸° (ë¡œë ˜ ì…ìˆ¨)</div>

    <!-- ê´‘ê³  ì˜ì—­ì€ ì›í•˜ì‹œë©´ ê·¸ëŒ€ë¡œ ë„£ìœ¼ì…”ë„ ë©ë‹ˆë‹¤(ìƒëµ ê°€ëŠ¥) -->

    <div style="margin-top:30px">
        <div class="help_title">ì£¼ìš” ê¸°ëŠ¥</div>
        <div class="help_doc">ìì—°ìŠ¤ëŸ¬ìš´ í•œê¸€ ìŠ¤íƒ€ì¼ì˜ ë¡œë ˜ ì…ìˆ¨ ìƒì„±, ë‹¤ì–‘í•œ ê¸¸ì´ì™€ ë¬¸ë‹¨ ì˜µì…˜ ì œê³µ, í…ìŠ¤íŠ¸ ì±„ìš°ê¸°ë¡œ ë ˆì´ì•„ì›ƒ ë””ìì¸ ì™„ì„±</div>

        <div class="help_title">í™œìš© ì˜ˆì‹œ</div>
        <div class="help_doc">
            ì›¹ì‚¬ì´íŠ¸ ë˜ëŠ” ì•± ë””ìì¸<br>
            ì¶œíŒë¬¼ ë ˆì´ì•„ì›ƒ í…ŒìŠ¤íŠ¸<br>
            ì‹œê°ì  í”„ë¡œí† íƒ€ì… ì œì‘
        </div>
    </div>

</div>

<script>
    // ====== ì„¤ì • ======
    const API_URL = "http://b973456356743434.cafe24.com/ipsum/ajax_hangul_ipsum.php"; // ì›ë³¸ ìœ ì§€

    // ====== ì—˜ë¦¬ë¨¼íŠ¸ ======
    const $ = (id) => document.getElementById(id);
    const form = $("ipsumForm");
    const selCount = $("text_line_count");
    const selLen = $("text_len");
    const selSource = $("text_source");
    const resultEl = $("result");
    const btnGenerate = $("btnGenerate");
    const btnCopy = $("btnCopy");
    const btnReload = $("btnReload");
    const btnBack = $("btnBack");
    const loadingDot = $("loadingDot");
    const loadingText = $("loadingText");

    // ====== ìœ í‹¸ ======
    function setLoading(on){
        loadingDot.classList.toggle("loading", on);
        loadingText.textContent = on ? "ìƒì„± ì¤‘..." : "ì™„ë£Œ";
    }

    function escapeHtml(str){
        // ì„œë²„ê°€ HTMLì„ ë‚´ë ¤ì£¼ëŠ” ê²½ìš°ë„ ìˆìœ¼ë‹ˆ,
        // "ê·¸ëŒ€ë¡œ í‘œì‹œ"ê°€ ëª©ì ì´ë©´ escape í•˜ì§€ ë§ê³  innerHTML ì‚¬ìš©.
        // ì§€ê¸ˆì€ ì›ë³¸ì²˜ëŸ¼ HTMLì„ ê·¸ëŒ€ë¡œ ë„£ì–´ ë ˆì´ì•„ì›ƒ í…ŒìŠ¤íŠ¸ì— ìœ ë¦¬í•˜ê²Œ í•¨.
        return str;
    }

    function buildCountOptions(max=30){
        const frag = document.createDocumentFragment();
        for(let i=1;i<=max;i++){
            const opt = document.createElement("option");
            opt.value = String(i);
            opt.textContent = String(i);
            frag.appendChild(opt);
        }
        selCount.appendChild(frag);
    }

    // ====== í•µì‹¬: ìƒì„± ìš”ì²­(ajaxForm ëŒ€ì²´) ======
    async function generateIpsum(){
        setLoading(true);
        resultEl.textContent = "";

        const fd = new FormData();
        fd.append("text_line_count", selCount.value);
        fd.append("text_len", selLen.value);
        fd.append("text_source", selSource.value);

        try{
            const res = await fetch(API_URL, {
                method: "POST",
                body: fd,
                credentials: "same-origin"
            });

            const data = await res.json(); // âœ… JSON

            if(String(data.code) === "300"){
                alert(data.message || "ìš”ì²­ì´ ì²˜ë¦¬ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");
                return;
            }

            if(String(data.code) === "200"){
                // âœ… ì„œë²„ì—ì„œ ì´ë¯¸ escape ì²˜ë¦¬ëœ <p>...</p> HTML
                resultEl.innerHTML = data.html || "";
            }else{
                alert("Error!! (Unexpected response)");
            }

        }catch(e){
            console.error(e);
            alert("ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
        }finally{
            setLoading(false);
        }
    }

    async function copyResult(){
        const plain = resultEl.innerText.trim();
        if(!plain){
            alert("ë³µì‚¬í•  ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤.");
            return;
        }
        try{
            await navigator.clipboard.writeText(plain);
            alert("ë³µì‚¬ ì™„ë£Œ!");
        }catch(e){
            // êµ¬í˜• ë¸Œë¼ìš°ì € fallback
            const ta = document.createElement("textarea");
            ta.value = plain;
            document.body.appendChild(ta);
            ta.select();
            document.execCommand("copy");
            document.body.removeChild(ta);
            alert("ë³µì‚¬ ì™„ë£Œ!");
        }
    }

    function setDefaults(){
        selCount.value = "5";
        selLen.value = "middle";
    }

    // ====== ì´ë²¤íŠ¸ ======
    btnGenerate.addEventListener("click", generateIpsum);
    btnReload.addEventListener("click", generateIpsum);
    btnCopy.addEventListener("click", copyResult);
    btnBack.addEventListener("click", ()=>history.back());

    // ====== ì‹œì‘ ======
    buildCountOptions(30);
    setDefaults();
    // ì›ë³¸ì²˜ëŸ¼ ë¡œë”© ì‹œ ìë™ 1íšŒ ìƒì„±
    generateIpsum();
</script>
</body>
</html>
