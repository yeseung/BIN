<!doctype html>
<html lang="ko">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>ì˜ê³ (Zalgo) í…ìŠ¤íŠ¸ ìƒì„±ê¸°</title>
    <style>
        :root{
            --bg:#f4f5f7;
            --card:#ffffff;
            --stroke:#e5e7eb;
            --text:#111827;
            --muted:#6b7280;
            --blue:#2563eb;
            --blue2:#1d4ed8;
            --radius:14px;
            --shadow: 0 18px 40px rgba(17,24,39,.08);
        }
        *{box-sizing:border-box}
        body{
            margin:0;
            font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans KR", Arial, sans-serif;
            background: var(--bg);
            color: var(--text);
        }
        .wrap{ max-width:1100px; margin:0 auto; padding:26px 16px 56px; }
        h1{ margin:6px 0 18px; font-size:34px; font-weight:900; letter-spacing:-.3px; }
        .card{
            background:var(--card);
            border:1px solid var(--stroke);
            border-radius:var(--radius);
            box-shadow:var(--shadow);
            padding:16px;
            margin-top:14px;
        }
        label{ display:block; font-weight:900; margin:0 0 8px; }
        textarea{
            width:100%;
            min-height:240px;
            resize:vertical;
            border:1px solid var(--stroke);
            border-radius:12px;
            padding:14px;
            outline:none;
            font-size:15px;
            line-height:2.0; /* ê²¹ì¹¨ ë°©ì§€: ë„‰ë„‰í•˜ê²Œ */
            background:#fbfbfc;
        }
        textarea:focus{
            border-color: rgba(37,99,235,.55);
            box-shadow: 0 0 0 4px rgba(37,99,235,.12);
            background:#fff;
        }
        .row{ display:flex; gap:14px; flex-wrap:wrap; align-items:flex-end; }
        .col{ flex:1; min-width:260px; }
        .btn{
            border:0; border-radius:12px;
            padding:11px 14px;
            font-weight:900;
            cursor:pointer;
            transition:transform .04s ease;
            display:inline-flex; align-items:center; gap:8px;
            white-space:nowrap;
        }
        .btn:active{ transform:translateY(1px); }
        .btn.primary{ background:linear-gradient(135deg,var(--blue),var(--blue2)); color:#fff; }
        .btn.gray{ background:linear-gradient(135deg,#9ca3af,#6b7280); color:#fff; }
        .btn.green{ background:linear-gradient(135deg,#10b981,#059669); color:#fff; }

        .help{ margin-top:10px; color:var(--muted); font-size:13px; line-height:1.6; }
        .control{ display:flex; gap:12px; flex-wrap:wrap; align-items:center; margin-top:10px; }
        .control .pill{
            border:1px solid var(--stroke);
            background:#fff;
            border-radius:999px;
            padding:8px 10px;
            display:flex; align-items:center; gap:10px;
            font-weight:900;
        }
        input[type="range"]{ width:280px; }
        .check{
            display:flex; align-items:center; gap:8px;
            margin-top:10px;
            color:#374151;
            font-weight:800;
        }

        .toast{
            position:fixed; left:50%; bottom:22px;
            transform:translateX(-50%);
            padding:10px 12px;
            border-radius:12px;
            background:rgba(17,24,39,.92);
            color:#fff;
            font-weight:900;
            box-shadow:0 12px 30px rgba(0,0,0,.20);
            opacity:0;
            pointer-events:none;
            transition:opacity .15s ease;
            z-index:9999;
        }
        .toast.show{ opacity:1; }
    </style>
</head>

<body>
<div class="wrap">
    <h1>ì˜ê³ (Zalgo) í…ìŠ¤íŠ¸ ìƒì„±ê¸°</h1>

    <div class="card">
        <label for="inText">í…ìŠ¤íŠ¸ ì…ë ¥:</label>
        <textarea id="inText" placeholder="ì—¬ê¸°ì— í…ìŠ¤íŠ¸ë¥¼ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”...&#10;ì˜ˆ) URL ëª©ë¡, ë¬¸ì¥ ë“±"></textarea>

        <div class="row" style="margin-top:12px;">
            <div class="col">
                <div class="control">
                    <div class="pill">
                        <span>ë³€í™˜ ê°•ë„</span>
                        <input id="strength" type="range" min="1" max="40" step="1" value="10" />
                        <span id="strengthLabel">10</span>
                    </div>

                    <div class="pill">
                        <span>ëœë¤ë„</span>
                        <input id="randomness" type="range" min="0" max="100" step="1" value="70" />
                        <span id="randomnessLabel">70%</span>
                    </div>
                </div>

                <label class="check">
                    <input id="preservePunct" type="checkbox" checked />
                    ê¸°í˜¸/ìˆ«ì(:// . ? & ë“±)ëŠ” ê·¸ëŒ€ë¡œ ë‘ê¸° (URL ê°€ë…ì„± ìœ ì§€)
                </label>

                <label class="check">
                    <input id="useLRM" type="checkbox" />
                    ë¬¸ì ì‚¬ì´ì— LRM(\u200E) ì‚½ì… (ê¶Œì¥ X, ì¼ë¶€ í™˜ê²½ì—ì„œ ë” ì–´ì§€ëŸ¬ì›€)
                </label>

                <div class="help">
                    â€¢ ì…ë ¥í•˜ë©´ ìë™ ë³€í™˜ë©ë‹ˆë‹¤. (CPU ë¶€ë‹´ ì¤„ì´ë ¤ë©´ í…ìŠ¤íŠ¸ê°€ ë§¤ìš° ê¸¸ ë•ŒëŠ” ë²„íŠ¼ìœ¼ë¡œë§Œ ì‹¤í–‰í•´ë„ ë©ë‹ˆë‹¤)<br>
                    â€¢ ì¤„ ê²¹ì¹¨ì´ ë³´ì´ë©´: ê°•ë„ë¥¼ ë‚®ì¶”ê³ (line-heightëŠ” ì´ë¯¸ ë„‰ë„‰), ëœë¤ë„ë¥¼ ì¤„ì—¬ë³´ì„¸ìš”.
                </div>
            </div>

            <div class="col" style="text-align:right;">
                <button class="btn primary" id="btnMake">âš¡ ìƒì„±</button>
                <button class="btn green" id="btnCopy">ğŸ“‹ ë³µì‚¬</button>
                <button class="btn gray" id="btnClear">ğŸ—‘ï¸ ë¹„ìš°ê¸°</button>
            </div>
        </div>
    </div>

    <div class="card">
        <label for="outText">ì˜ê³  í…ìŠ¤íŠ¸:</label>
        <textarea id="outText" readonly placeholder="ìƒì„± ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤."></textarea>
        <div class="help">
            ì˜ê³  í…ìŠ¤íŠ¸ëŠ” ìœ ë‹ˆì½”ë“œ ê²°í•©ë¬¸ì(Combining marks)ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ì•±/í°íŠ¸ì— ë”°ë¼ ëª¨ì–‘ì´ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆì–´ìš”.
        </div>
    </div>
</div>

<div class="toast" id="toast">ë³µì‚¬í–ˆìŠµë‹ˆë‹¤!</div>

<script>
    // =========================
    // Combining marks (ì •ìƒ ë²”ìœ„)
    // =========================
    // (ê¸°ì¡´ ì½”ë“œì˜ 7616~ ê°™ì€ íŠ¹ìˆ˜ ë²”ìœ„ëŠ” í°íŠ¸/í™˜ê²½ì— ë”°ë¼ ë” ê¹¨ì ¸ ë³´ì¼ ìˆ˜ ìˆì–´ ì œì™¸)
    const ZALGO_TOP = [
        768,769,770,771,772,773,774,775,776,777,778,779,780,781,782,783,784,785,786,787,788,789,
        794,795,830,831,832,833,834,835,836,838,842,843,844,848,849,850,855,857,858,859,861,862,864,865
    ];
    const ZALGO_MID = [820,821,822,823,824];
    const ZALGO_BOTTOM = [
        825,826,827,828,829,837,839,840,841,845,846,851,852,853,854,860,863,866,
        800,801,802,803,804,805,806,807,808,809,810,811,812,813,814,815,816,817,818,819,
        790,791,792,793,796,797,798,799
    ];

    // =========================
    // Utils
    // =========================
    const $ = (id) => document.getElementById(id);

    function randInt(min, max){
        return Math.floor(Math.random() * (max - min + 1)) + min;
    }
    function pickCode(arr){
        return arr[Math.floor(Math.random() * arr.length)];
    }
    function shouldApply(randomness){
        return Math.random() * 100 < randomness;
    }

    // "ê¸°í˜¸/ìˆ«ì ë³´ì¡´"ì¼ ë•ŒëŠ” í•œê¸€/ì˜ë¬¸ë§Œ ë³€í™˜
    function isTargetChar(ch, preservePunct){
        if (ch === "\n" || ch === "\r" || ch === "\t" || ch === " ") return false;
        const code = ch.codePointAt(0);

        const isHangul = (code >= 0xAC00 && code <= 0xD7A3);
        const isLatin  = ((code >= 0x41 && code <= 0x5A) || (code >= 0x61 && code <= 0x7A));

        if (preservePunct) return isHangul || isLatin;

        // preservePunct í•´ì œ ì‹œ: ì œì–´ë¬¸ìë§Œ ì œì™¸í•˜ê³  ëŒ€ë¶€ë¶„ í—ˆìš©
        if (code < 0x20) return false;
        return true;
    }

    function makeMarks(arr, count){
        let s = "";
        for (let i=0; i<count; i++){
            s += String.fromCharCode(pickCode(arr));
        }
        return s;
    }

    function zalgoify(text, strength, randomness, preservePunct, useLRM){
        let out = "";

        // strength(1~40)ë¥¼ "ìµœëŒ€ ê²°í•©ë¬¸ì ìˆ˜"ë¡œ ì‚¬ìš©
        // ë„ˆë¬´ ê³¼í•œ ê²¹ì¹¨ ì¤„ì´ë ¤ê³  top/bottomì€ strengthì˜ 60% ì •ë„ë§Œ ì‚¬ìš©
        const topMax = Math.max(1, Math.round(strength * 0.6));
        const botMax = Math.max(1, Math.round(strength * 0.6));
        const midMax = Math.max(0, Math.round(strength * 0.15));

        for (const ch of text){
            if (!isTargetChar(ch, preservePunct) || !shouldApply(randomness)){
                out += ch;
                continue;
            }

            const t = randInt(1, topMax);
            const b = randInt(1, botMax);
            const m = midMax ? randInt(0, midMax) : 0;

            const top = makeMarks(ZALGO_TOP, t);
            const mid = makeMarks(ZALGO_MID, m);
            const bot = makeMarks(ZALGO_BOTTOM, b);

            // LRM(\u200E)ëŠ” ì˜µì…˜ìœ¼ë¡œë§Œ (ê¸°ë³¸ OFF)
            out += top + ch + (useLRM ? "\u200E" : "") + mid + bot;
        }
        return out;
    }

    // =========================
    // UI
    // =========================
    let toastTimer = null;
    function toast(msg){
        const el = $("toast");
        el.textContent = msg;
        el.classList.add("show");
        clearTimeout(toastTimer);
        toastTimer = setTimeout(()=> el.classList.remove("show"), 1200);
    }

    function run(){
        const input = $("inText").value || "";
        const strength = Number($("strength").value || 10);
        const randomness = Number($("randomness").value || 70);
        const preservePunct = $("preservePunct").checked;
        const useLRM = $("useLRM").checked;

        $("strengthLabel").textContent = String(strength);
        $("randomnessLabel").textContent = String(randomness) + "%";

        if (!input){
            $("outText").value = "";
            return;
        }
        $("outText").value = zalgoify(input, strength, randomness, preservePunct, useLRM);
    }

    async function copyOut(){
        const v = $("outText").value;
        if (!v) return;
        try{
            await navigator.clipboard.writeText(v);
            toast("ë³µì‚¬í–ˆìŠµë‹ˆë‹¤!");
        }catch(e){
            $("outText").focus();
            $("outText").select();
            document.execCommand("copy");
            toast("ë³µì‚¬í–ˆìŠµë‹ˆë‹¤!");
        }
    }

    function clearAll(){
        $("inText").value = "";
        $("outText").value = "";
    }

    // =========================
    // Events
    // =========================
    document.addEventListener("DOMContentLoaded", () => {
        // ê¸°ë³¸ ì¦‰ì‹œ ë³€í™˜
        ["input","change"].forEach(evt => {
            $("inText").addEventListener(evt, run);
            $("strength").addEventListener(evt, run);
            $("randomness").addEventListener(evt, run);
            $("preservePunct").addEventListener(evt, run);
            $("useLRM").addEventListener(evt, run);
        });

        $("btnMake").addEventListener("click", run);
        $("btnCopy").addEventListener("click", copyOut);
        $("btnClear").addEventListener("click", clearAll);

        // ì´ˆê¸° í•œ ë²ˆ
        run();
    });
</script>
</body>
</html>
