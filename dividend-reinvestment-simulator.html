<!doctype html>
<html lang="ko">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>ë°°ë‹¹ ì¬íˆ¬ì ì‹œë®¬ë ˆì´ì…˜ ê³„ì‚°ê¸°</title>

    <style>
        :root{
            --bg:#f6f7fb;
            --card:#ffffff;
            --line:#e5e7eb;
            --text:#111827;
            --muted:#6b7280;
            --primary:#2563eb;
            --primary2:#1d4ed8;
            --danger:#ef4444;
            --danger2:#dc2626;
            --shadow:0 10px 30px rgba(0,0,0,.06);
            --radius:16px;
        }
        *{box-sizing:border-box}
        body{
            margin:0;
            background:var(--bg);
            color:var(--text);
            font:14px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Noto Sans KR,sans-serif;
        }
        .page-wrap{max-width:980px;margin:18px auto;padding:0 14px}
        h4{margin:0 0 10px 0;font-size:18px}
        b{font-weight:900}

        .glass-card{
            background:var(--card);
            border:1px solid var(--line);
            border-radius:var(--radius);
            box-shadow:var(--shadow);
            padding:14px;
            margin:12px 0;
        }
        .info-box{
            margin:12px 0;
            padding:12px 14px;
            border-radius:16px;
            border:1px solid rgba(37,99,235,.22);
            background:rgba(37,99,235,.06);
            color:#1e3a8a;
        }
        .warning-box{
            margin-top:12px;
            padding:12px 14px;
            border-radius:16px;
            border:1px solid rgba(245,158,11,.25);
            background:rgba(245,158,11,.10);
        }

        .input-sections-container{
            display:flex;
            gap:14px;
            align-items:flex-start;
        }
        @media (max-width:860px){
            .input-sections-container{flex-direction:column}
        }

        label{font-weight:900}
        .form-input, .form-select{
            width:100%;
            padding:11px 12px;
            border-radius:14px;
            border:1px solid var(--line);
            outline:none;
            background:#fff;
            font-size:14px;
        }
        .form-input:focus, .form-select:focus{
            border-color:rgba(37,99,235,.5);
            box-shadow:0 0 0 4px rgba(37,99,235,.12);
        }
        small{display:inline-block;margin-top:6px;color:var(--muted)}

        .button-container{
            display:flex;
            gap:10px;
            justify-content:center;
            flex-wrap:wrap;
        }
        .glass-button{
            border:0;
            border-radius:14px;
            padding:11px 14px;
            background:linear-gradient(135deg,#3B82F6,#1D4ED8);
            color:#fff;
            font-weight:900;
            cursor:pointer;
            box-shadow:0 10px 20px rgba(37,99,235,.18);
            user-select:none;
        }
        .glass-button:hover{filter:brightness(.98)}
        .glass-button:active{transform:translateY(1px)}
        .glass-button:disabled{
            cursor:not-allowed;
            filter:grayscale(.2) brightness(.95);
            opacity:.85;
        }
        .clear-button{
            background:linear-gradient(135deg,#95a5a6,#7f8c8d);
            box-shadow:0 10px 20px rgba(0,0,0,.10);
        }

        /* validation */
        .error{border-color:rgba(239,68,68,.75)!important; box-shadow:0 0 0 4px rgba(239,68,68,.12)!important}
        .success{border-color:rgba(16,185,129,.6)!important; box-shadow:0 0 0 4px rgba(16,185,129,.10)!important}

        /* result */
        #result h5{margin:0 0 10px 0}
        #result-content{
            background:#f9fafb;
            padding:14px;
            border-radius:14px;
            border:1px solid var(--line);
            font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Courier New",monospace;
            font-size:13px;
            max-height:520px;
            overflow:auto;
        }

        table{
            width:100%;
            border-collapse:collapse;
            margin-top:10px;
            background:#fff;
            border:1px solid var(--line);
            border-radius:12px;
            overflow:hidden;
        }
        th, td{
            border-bottom:1px solid var(--line);
            padding:10px 8px;
            text-align:right;
            white-space:nowrap;
            font-size:12.5px;
        }
        th{
            background:#f3f4f6;
            color:#111827;
            font-weight:900;
        }
        td:first-child, th:first-child{text-align:left}
        tr:hover td{background:#fafafa}
    </style>
</head>

<body>
<div class="page-wrap">
    <h4><b>ë°°ë‹¹ ì¬íˆ¬ì ì‹œë®¬ë ˆì´ì…˜ ê³„ì‚°ê¸°</b></h4>

    <div class="info-box">
        <p style="font-size:14px;margin:0;">
            ê°„í¸í•˜ê²Œ ë°°ë‹¹ê¸ˆì„ ëª¨ë‘ ì¬íˆ¬ì í–ˆì„ ê²½ìš° ìƒí™©ì„ ì‹œë®¬ë ˆì´ì…˜ í•´ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>
            â€» ë°°ë‹¹ê¸ˆì€ ëª¨ë‘ ê°™ì€ ì£¼ì‹ì„ ì¬íˆ¬ì í•œë‹¤ê³  ê°€ì •<br>
            â€» ì£¼ì‹ì˜ ë¶€ë¶„ íˆ¬ì (ì†Œìˆ˜ì  ë§¤ìˆ˜) ëŠ” ë¶ˆê°€í•˜ë‹¤ê³  ê°€ì •
        </p>
    </div>

    <div class="glass-card">
        <div class="input-sections-container">
            <div style="flex:1;">
                <div style="margin:10px 0;">
                    <label for="investMoney">í˜„ì¬ íˆ¬ì ê¸ˆì•¡ <span style="color:red;">*</span></label>
                    <input type="number" step="any" id="investMoney" class="form-input" placeholder="ì˜ˆ: 1000000">
                </div>
                <div style="margin:10px 0;">
                    <label for="stockPrice">ì£¼ì‹ 1ì£¼ë‹¹ ê°€ê²© <span style="color:red;">*</span></label>
                    <input type="number" step="any" id="stockPrice" class="form-input" placeholder="ì˜ˆ: 50000">
                </div>
                <div style="margin:10px 0;">
                    <label for="dividendRate">ì‹œê°€ë°°ë‹¹ë¥  (%) <span style="color:red;">*</span></label>
                    <input type="number" step="any" id="dividendRate" class="form-input" placeholder="ì˜ˆ: 3.4">
                    <small>â€» 1ë…„ ë°°ë‹¹ìˆ˜ìµë¥  ê¸°ì¤€</small>
                </div>
                <div style="margin:10px 0;">
                    <label for="stockGrowthRate">ì£¼ì‹ ì—°í‰ê·  ìƒìŠ¹ë¥  (%) <span style="color:red;">*</span></label>
                    <input type="number" step="any" id="stockGrowthRate" class="form-input" value="3.0" placeholder="ì˜ˆ: 3.0">
                </div>
            </div>

            <div style="flex:1;">
                <div style="margin:10px 0;">
                    <label for="taxRate">ë°°ë‹¹ì†Œë“ì„¸ (%) <span style="color:red;">*</span></label>
                    <input type="number" step="any" id="taxRate" class="form-input" value="15.4" placeholder="ì˜ˆ: 15.4">
                </div>
                <div style="margin:10px 0;">
                    <label for="dividendCycle">ë°°ë‹¹ì£¼ê¸° <span style="color:red;">*</span></label>
                    <select id="dividendCycle" class="form-input">
                        <option value="1">ë§¤ì›” ë°°ë‹¹</option>
                        <option value="2">ë¶„ê¸° ë°°ë‹¹</option>
                        <option value="3">ë°˜ê¸° ë°°ë‹¹</option>
                        <option value="4">ì—° ë°°ë‹¹</option>
                    </select>
                </div>
                <div style="margin:10px 0;">
                    <label for="durationYears">ì‹œë®¬ë ˆì´ì…˜ ì¶œë ¥ ê¸°ê°„(ë…„) <span style="color:red;">*</span></label>
                    <input type="number" step="1" id="durationYears" class="form-input" value="10" placeholder="ì˜ˆ: 10">
                </div>
            </div>
        </div>

        <div class="warning-box">
            <p style="margin:0;font-size:13px;color:#856404;">
                <strong>ğŸ“‹ ë°°ë‹¹ì£¼ê¸° ì•ˆë‚´:</strong><br>
                â€¢ ë§¤ì›” ë°°ë‹¹: ë°°ë‹¹ê¸ˆ ë§¤ì›” ë°°ë‹¹<br>
                â€¢ ë¶„ê¸° ë°°ë‹¹: 3, 6, 9, 12ì›” ë°°ë‹¹ ê°€ì •<br>
                â€¢ ë°˜ê¸° ë°°ë‹¹: 6, 12ì›” ë°°ë‹¹ ê°€ì •<br>
                â€¢ ì—° ë°°ë‹¹: 12ì›” ë°°ë‹¹ ê°€ì •
            </p>
        </div>
    </div>

    <div class="glass-card">
        <div class="button-container">
            <button onclick="dividendCalc()" class="glass-button" id="calcButton">ğŸ’° ë°°ë‹¹ê¸ˆ ê³„ì‚°í•˜ê¸°</button>
            <button onclick="clearAllInputs()" class="glass-button clear-button">ğŸ—‘ï¸ ì´ˆê¸°í™”</button>
        </div>
    </div>

    <div id="result" class="glass-card" style="display:none;">
        <h5 style="color:#1e3a8a;margin:0 0 10px 0;font-size:18px;font-weight:900;">ğŸ“Š ë°°ë‹¹ ì‹œë®¬ë ˆì´ì…˜ ê²°ê³¼</h5>
        <div id="result-content"></div>
    </div>
</div>

<script>
    function dividendCalc() {
        const calcButton = document.getElementById('calcButton');
        calcButton.disabled = true;
        const originalText = calcButton.innerHTML;
        calcButton.innerHTML = 'â³ ê³„ì‚° ì¤‘...';

        document.getElementById('result').style.display = 'none';

        const investMoney = parseFloat(document.getElementById('investMoney').value);
        let stockPrice = parseFloat(document.getElementById('stockPrice').value);
        const dividendRate = parseFloat(document.getElementById('dividendRate').value) / 100;
        const stockGrowthRate = parseFloat(document.getElementById('stockGrowthRate').value) / 100;
        const taxRate = parseFloat(document.getElementById('taxRate').value) / 100;
        const dividendCycle = parseInt(document.getElementById('dividendCycle').value, 10);
        const durationYears = parseInt(document.getElementById('durationYears').value, 10);

        if (
            isNaN(investMoney) || isNaN(stockPrice) || isNaN(dividendRate) || isNaN(stockGrowthRate) || isNaN(taxRate) || isNaN(durationYears) ||
            investMoney <= 0 || stockPrice <= 0 || dividendRate < 0 || stockGrowthRate < 0 || taxRate < 0 || durationYears <= 0
        ) {
            showError("ëª¨ë“  í•­ëª©ì„ ì •í™•í•˜ê²Œ ì…ë ¥í•´ì£¼ì„¸ìš”.");
            calcButton.innerHTML = originalText;
            calcButton.disabled = false;
            return;
        }

        setTimeout(() => {
            try {
                let currentStocks = Math.floor(investMoney / stockPrice);
                let remainingCash = investMoney % stockPrice;
                let accumulatedDividend = 0;

                const monthlyStockGrowth = Math.pow(1 + stockGrowthRate, 1 / 12) - 1;

                const startDate = new Date();
                let currentYear = startDate.getFullYear();
                let currentMonth = startDate.getMonth() + 1;

                let resultHtml = '<h6 style="margin:0 0 10px 0;"><b>[ ì „ì²´ ìˆ˜ìµ ê°œìš” ]</b></h6>';

                // í…Œì´ë¸” í—¤ë”
                let tableHtml = '<h6 style="margin:18px 0 8px 0;"><b>[ ë°°ë‹¹ ì‹œë®¬ë ˆì´ì…˜ ê²°ê³¼ ]</b></h6>';
                tableHtml += `<p style="margin:0 0 10px 0;"><b>ì‹œì‘ íˆ¬ìê¸ˆ :</b> ${money(investMoney)} ì›</p>`;
                tableHtml += '<table><thead><tr>' +
                    '<th>ê¸°ê°„</th>' +
                    '<th>ì´ í‰ê°€ê¸ˆì•¡</th>' +
                    '<th>1ì£¼ë‹¹ ê°€ê²©</th>' +
                    '<th>ë³´ìœ  ì£¼ì‹ ìˆ˜</th>' +
                    '<th>ì›”í‰ê·  ë°°ë‹¹ê¸ˆ</th>' +
                    '<th>ì—°í™˜ì‚° ë°°ë‹¹ê¸ˆ</th>' +
                    '</tr></thead><tbody>';

                // ë°°ë‹¹ í‘œê¸°ìš©(ìµœê·¼ ë°°ë‹¹ ì‹œì  ê¸°ì¤€)
                let currentAnnualDividend = 0;
                let currentMonthlyAverageDividend = 0;

                const monthsTotal = durationYears * 12;

                for (let i = 0; i < monthsTotal; i++) {
                    const monthIndex = (currentMonth - 1) % 12;
                    let isDividendMonth = false;
                    let monthlyDividend = 0;

                    // ë°°ë‹¹ ì§€ê¸‰ (ì„¸í›„, ì§€ê¸‰ì›”ë§Œ ì§€ê¸‰)
                    if (dividendCycle === 1) {
                        isDividendMonth = true;
                        monthlyDividend = (currentStocks * stockPrice * dividendRate / 12) * (1 - taxRate);
                    } else if (dividendCycle === 2) {
                        if (monthIndex === 2 || monthIndex === 5 || monthIndex === 8 || monthIndex === 11) {
                            isDividendMonth = true;
                            monthlyDividend = (currentStocks * stockPrice * dividendRate / 4) * (1 - taxRate);
                        }
                    } else if (dividendCycle === 3) {
                        if (monthIndex === 5 || monthIndex === 11) {
                            isDividendMonth = true;
                            monthlyDividend = (currentStocks * stockPrice * dividendRate / 2) * (1 - taxRate);
                        }
                    } else if (dividendCycle === 4) {
                        if (monthIndex === 11) {
                            isDividendMonth = true;
                            monthlyDividend = (currentStocks * stockPrice * dividendRate) * (1 - taxRate);
                        }
                    }

                    if (isDividendMonth) {
                        accumulatedDividend += monthlyDividend;

                        // "ìµœê·¼ ë°°ë‹¹ ì‹œì " ê¸°ì¤€ ì—°í™˜ì‚°/ì›”í‰ê·  ì—…ë°ì´íŠ¸
                        if (dividendCycle === 1) {
                            currentAnnualDividend = currentStocks * stockPrice * dividendRate * (1 - taxRate);
                        } else if (dividendCycle === 2) {
                            currentAnnualDividend = monthlyDividend * 4;
                        } else if (dividendCycle === 3) {
                            currentAnnualDividend = monthlyDividend * 2;
                        } else if (dividendCycle === 4) {
                            currentAnnualDividend = monthlyDividend;
                        }
                        currentMonthlyAverageDividend = currentAnnualDividend / 12;
                    }

                    // ë°°ë‹¹ê¸ˆ ì¬íˆ¬ì (ì •ìˆ˜ ì£¼ì‹ë§Œ)
                    if (accumulatedDividend >= stockPrice) {
                        const purchasable = Math.floor(accumulatedDividend / stockPrice);
                        currentStocks += purchasable;
                        accumulatedDividend -= purchasable * stockPrice;
                    }

                    const totalValue = (currentStocks * stockPrice) + accumulatedDividend + remainingCash;

                    tableHtml += `<tr>
          <td>${currentYear}ë…„ ${currentMonth}ì›”</td>
          <td>${money(totalValue)}</td>
          <td>${money(stockPrice)}</td>
          <td>${currentStocks.toLocaleString('ko-KR')}</td>
          <td>${money(currentMonthlyAverageDividend)}</td>
          <td>${money(currentAnnualDividend)}</td>
        </tr>`;

                    // ì£¼ê°€ ìƒìŠ¹
                    stockPrice *= (1 + monthlyStockGrowth);

                    // ë‹¬ë ¥ ë„˜ê¹€
                    currentMonth++;
                    if (currentMonth > 12) {
                        currentMonth = 1;
                        currentYear++;
                    }
                }

                tableHtml += '</tbody></table>';

                // ìµœì¢… ìš”ì•½ (ë§ˆì§€ë§‰ ì›” ìƒìŠ¹ ë°˜ì˜ëœ stockPrice ê°’ ê¸°ì¤€)
                const finalValue = (currentStocks * stockPrice) + accumulatedDividend + remainingCash;
                const profit = finalValue - investMoney;
                const returnRate = (profit / investMoney) * 100;

                resultHtml += `
        <p style="margin:0 0 6px 0;"><b>ìµœì¢… í‰ê°€ê¸ˆì•¡ :</b> ${money(finalValue)} ì›</p>
        <p style="margin:0 0 10px 0;"><b>ì´ ìˆ˜ìµ :</b> ${money(profit)} ì› (${returnRate.toFixed(2)}%)</p>
      `;

                document.getElementById('result-content').innerHTML = resultHtml + tableHtml;
                document.getElementById('result').style.display = 'block';
            } catch (err) {
                showError("ê³„ì‚° ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: " + err.message);
            } finally {
                calcButton.innerHTML = originalText;
                calcButton.disabled = false;
            }
        }, 60);
    }

    function money(n){
        if (!isFinite(n)) return '0';
        return Number(n).toLocaleString('ko-KR', { maximumFractionDigits: 2 });
    }

    function showError(message) {
        document.getElementById('result-content').innerHTML =
            `<div style="color:#b91c1c;padding:14px;background:#ffebee;border-radius:14px;border:1px solid rgba(185,28,28,.2);">
      âŒ <b>${escapeHtml(message)}</b>
    </div>`;
        document.getElementById('result').style.display = 'block';
    }

    function escapeHtml(text){
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
    }

    function clearAllInputs() {
        const fields = ['investMoney','stockPrice','dividendRate','stockGrowthRate','taxRate','durationYears'];
        fields.forEach(id => {
            const el = document.getElementById(id);
            if (id === 'stockGrowthRate') el.value = '3.0';
            else if (id === 'taxRate') el.value = '15.4';
            else if (id === 'durationYears') el.value = '10';
            else el.value = '';
            el.classList.remove('error','success');
        });
        document.getElementById('dividendCycle').value = '1';
        document.getElementById('result').style.display = 'none';
    }

    function addInputValidation() {
        const fields = ['investMoney','stockPrice','dividendRate','stockGrowthRate','taxRate','durationYears'];
        fields.forEach(id => {
            const el = document.getElementById(id);
            el.addEventListener('input', function(){
                const v = parseFloat(this.value);
                if (this.value.trim() && (isNaN(v) || v <= 0)) {
                    this.classList.remove('success');
                    this.classList.add('error');
                } else if (this.value.trim()) {
                    this.classList.remove('error');
                    this.classList.add('success');
                } else {
                    this.classList.remove('error','success');
                }
            });
        });
    }

    document.addEventListener('DOMContentLoaded', () => addInputValidation());
</script>
</body>
</html>
