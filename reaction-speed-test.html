<!doctype html>
<html lang="ko">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ë°˜ì‘ì†ë„ í…ŒìŠ¤íŠ¸ - Reaction Speed Test</title>

    <!-- https://www.jiraksil.com/service/reaction_speed -->

    <style>
        :root{
            --bg:#f6f7fb;
            --card:#ffffff;
            --text:#111827;
            --muted:#6b7280;
            --line:#e5e7eb;
            --shadow:0 10px 25px rgba(0,0,0,.08);
            --radius:16px;

            --blue:#2563eb;
            --red:#ef4444;
            --green:#22c55e;
            --yellow:#f59e0b;
        }
        *{box-sizing:border-box;margin:0;padding:0;}
        body{
            font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Noto Sans KR",sans-serif;
            background:var(--bg);
            color:var(--text);
            min-height:100vh;
            display:flex;
            justify-content:center;
            user-select:none;
            -webkit-user-select:none;
        }
        .wrap{
            width:100%;
            max-width:720px;
            padding:18px;
        }

        .title{
            font-size:22px;
            font-weight:900;
            letter-spacing:-0.2px;
        }
        .desc{
            margin-top:6px;
            color:var(--muted);
            font-size:13px;
            line-height:1.55;
        }

        .card{
            margin-top:14px;
            background:var(--card);
            border:1px solid var(--line);
            border-radius:var(--radius);
            box-shadow:var(--shadow);
            padding:14px;
        }

        .hud{
            display:flex;
            gap:10px;
            flex-wrap:wrap;
        }
        .hud-item{
            flex:1 1 160px;
            border:1px solid var(--line);
            border-radius:14px;
            background:#fafafa;
            padding:10px 12px;
            min-width:150px;
        }
        .hud-label{font-size:12px;color:var(--muted);margin-bottom:6px;}
        .hud-val{font-size:18px;font-weight:900;letter-spacing:-0.2px;}

        .zone{
            margin-top:14px;
            height:380px;
            border-radius:var(--radius);
            border:1px solid var(--line);
            box-shadow:var(--shadow);
            display:flex;
            flex-direction:column;
            align-items:center;
            justify-content:center;
            text-align:center;
            padding:18px;
            cursor:pointer;
            touch-action:manipulation;
            transition:transform .08s, background-color .2s;
            position:relative;
            overflow:hidden;
            background:#eef2ff;
        }
        .zone:active{ transform:scale(.985); }

        .state-waiting{ background:#eef2ff; }
        .state-ready{ background:#ffecec; }
        .state-go{ background:#e9fff1; }
        .state-error{ background:#fff7e6; }

        .badge{
            width:64px;
            height:64px;
            border-radius:18px;
            display:flex;
            align-items:center;
            justify-content:center;
            font-size:30px;
            margin-bottom:14px;
            border:1px solid rgba(17,24,39,.08);
            background:rgba(255,255,255,.7);
            box-shadow:0 10px 20px rgba(0,0,0,.06);
        }

        .main{
            font-size:26px;
            font-weight:900;
            letter-spacing:-0.4px;
        }
        .sub{
            margin-top:10px;
            color:var(--muted);
            font-size:14px;
            line-height:1.5;
        }

        .hint{
            position:absolute;
            bottom:14px;
            left:50%;
            transform:translateX(-50%);
            font-size:12px;
            color:rgba(17,24,39,.45);
        }

        .pulse{ animation:pulse .9s ease-in-out infinite alternate; }
        @keyframes pulse{ from{ transform:scale(.98);} to{ transform:scale(1.05);} }

        .shake{ animation:shake .35s ease-in-out; }
        @keyframes shake{
            0%,100%{ transform:translateX(0); }
            25%{ transform:translateX(-10px); }
            75%{ transform:translateX(10px); }
        }

        /* result overlay */
        .overlay{
            position:absolute;
            inset:0;
            background:rgba(255,255,255,.92);
            display:none;
            align-items:center;
            justify-content:center;
            padding:16px;
            z-index:5;
        }
        .panel{
            width:min(420px, 95%);
            background:#fff;
            border:1px solid var(--line);
            border-radius:18px;
            box-shadow:var(--shadow);
            padding:18px;
            text-align:center;
        }
        .panel h2{
            font-size:22px;
            margin-bottom:10px;
            letter-spacing:-0.2px;
        }
        .big{
            font-size:34px;
            font-weight:900;
            letter-spacing:-0.4px;
            margin:8px 0 6px;
        }
        .comment{
            color:var(--muted);
            font-size:14px;
            line-height:1.55;
            margin-top:10px;
        }
        .btn{
            margin-top:14px;
            width:100%;
            border:none;
            border-radius:12px;
            padding:12px 14px;
            font-weight:900;
            cursor:pointer;
            background:#111827;
            color:#fff;
        }
        .btn.secondary{
            background:#fff;
            color:#111827;
            border:1px solid var(--line);
            margin-top:10px;
        }

        @media (max-width:420px){
            .zone{ height:320px; }
            .main{ font-size:22px; }
        }
    </style>
</head>

<body>
<div class="wrap">
    <div class="title">âš¡ ë°˜ì‘ì†ë„ í…ŒìŠ¤íŠ¸</div>
    <div class="desc">
        í™”ë©´ì´ <b style="color:var(--green)">ì´ˆë¡ë¹›</b>ìœ¼ë¡œ ë°”ë€Œë©´ ìµœëŒ€í•œ ë¹¨ë¦¬ í´ë¦­í•˜ì„¸ìš”.<br/>
        ì´ <b>5ë²ˆ</b> ì¸¡ì •í•´ì„œ í‰ê· ì„ ëƒ…ë‹ˆë‹¤. (ë‚šì‹œ ë©˜íŠ¸ ì£¼ì˜)
    </div>

    <div class="card">
        <div class="hud">
            <div class="hud-item">
                <div class="hud-label">ë¼ìš´ë“œ</div>
                <div class="hud-val" id="roundTxt">0 / 5</div>
            </div>
            <div class="hud-item">
                <div class="hud-label">í˜„ì¬ ê¸°ë¡</div>
                <div class="hud-val" id="curTxt">-- ms</div>
            </div>
            <div class="hud-item">
                <div class="hud-label">í‰ê· </div>
                <div class="hud-val" id="avgTxt">-- ms</div>
            </div>
        </div>
    </div>

    <div class="zone state-waiting" id="zone" role="button" aria-label="ë°˜ì‘ì†ë„ í…ŒìŠ¤íŠ¸ ì˜ì—­" tabindex="0">
        <div class="badge" id="badge">ğŸ–±ï¸</div>
        <div class="main" id="mainTxt">í´ë¦­í•´ì„œ ì‹œì‘í•˜ê¸°</div>
        <div class="sub" id="subTxt">ê¸´ì¥ í‘¸ì‹œê³ â€¦</div>
        <div class="hint">í´ë¦­/í„°ì¹˜/ìŠ¤í˜ì´ìŠ¤(ì„ íƒ)</div>

        <div class="overlay" id="overlay">
            <div class="panel">
                <h2>ì¸¡ì • ì™„ë£Œ!</h2>
                <div style="font-size:44px;" id="emoji">ğŸ¢</div>
                <div class="big"><span id="finalAvg">0</span> ms</div>
                <div class="comment" id="comment"></div>
                <button class="btn" id="retryBtn">ë‹¤ì‹œ ë„ì „</button>
                <button class="btn secondary" id="closeBtn">ë‹«ê¸°</button>
            </div>
        </div>
    </div>
</div>

<script>
    (() => {
        // ===== config =====
        const maxRounds = 5;

        // ë‚šì‹œ ë©˜íŠ¸
        const fakeTexts = [
            "ì...ì¥ë©´!", "ì§€...ê°‘!", "ì¤€...ë¹„ë¬¼!", "ì´ˆ...ì½œë¦¿!",
            "ê¸°...ë‹¤ë ¤!", "ì•„...ì§!", "ì§€ê¸ˆ...ì€ ì•„ë‹˜!"
        ];

        // ===== DOM =====
        const zone = document.getElementById('zone');
        const badge = document.getElementById('badge');
        const mainTxt = document.getElementById('mainTxt');
        const subTxt = document.getElementById('subTxt');

        const roundTxt = document.getElementById('roundTxt');
        const curTxt = document.getElementById('curTxt');
        const avgTxt = document.getElementById('avgTxt');

        const overlay = document.getElementById('overlay');
        const emoji = document.getElementById('emoji');
        const finalAvg = document.getElementById('finalAvg');
        const comment = document.getElementById('comment');
        const retryBtn = document.getElementById('retryBtn');
        const closeBtn = document.getElementById('closeBtn');

        // ===== state =====
        let state = 'waiting'; // waiting, ready, go, error
        let startTime = 0;
        let records = [];
        let timers = [];
        let lock = false;

        function setZoneState(cls){
            zone.classList.remove('state-waiting','state-ready','state-go','state-error','shake');
            zone.classList.add(cls);
        }

        function clearTimers(){
            timers.forEach(id => clearTimeout(id));
            timers = [];
        }

        function avg(){
            if(!records.length) return 0;
            return Math.floor(records.reduce((a,b)=>a+b,0) / records.length);
        }

        function updateHUD(current){
            roundTxt.textContent = `${records.length} / ${maxRounds}`;
            curTxt.textContent = current != null ? `${current} ms` : '-- ms';
            avgTxt.textContent = records.length ? `${avg()} ms` : '-- ms';
        }

        function softLock(ms=180){
            lock = true;
            setTimeout(() => lock = false, ms);
        }

        function startReady(){
            if(lock) return;
            softLock();
            clearTimers();

            state = 'ready';
            setZoneState('state-ready');

            badge.textContent = 'ğŸš¦';
            badge.classList.remove('pulse');
            mainTxt.textContent = 'ì´ˆë¡ë¹›ì´ ë˜ë©´ í´ë¦­!';
            subTxt.textContent = 'ê¸°ë‹¤ë ¤â€¦ (ë‚šì‹œ ì£¼ì˜)';
            updateHUD(null);

            // 2~5ì´ˆ ëŒ€ê¸°
            const randomTime = Math.floor(Math.random() * 3000) + 2000;

            // 30% í™•ë¥  ë‚šì‹œ ë©˜íŠ¸
            if(Math.random() < 0.3 && randomTime > 1100){
                const fakeTime = Math.floor(Math.random() * (randomTime - 900)) + 450;
                timers.push(setTimeout(() => {
                    if(state !== 'ready') return;
                    const t = fakeTexts[Math.floor(Math.random() * fakeTexts.length)];
                    mainTxt.textContent = t;
                    subTxt.textContent = 'ì†ì•˜ì§€? ê³„ì† ê¸°ë‹¤ë ¤!';
                }, fakeTime));
            }

            timers.push(setTimeout(triggerGo, randomTime));
        }

        function triggerGo(){
            if(state !== 'ready') return;

            state = 'go';
            startTime = performance.now();

            setZoneState('state-go');
            badge.textContent = 'âš¡';
            badge.classList.add('pulse');
            mainTxt.textContent = 'ì§€ê¸ˆ í´ë¦­!!!';
            subTxt.textContent = 'GO! GO! GO!';
        }

        function failTooSoon(){
            state = 'error';
            clearTimers();
            softLock();

            setZoneState('state-error');
            zone.classList.add('shake');

            badge.textContent = 'âš ï¸';
            badge.classList.remove('pulse');

            const msgs = [
                "ë„ˆë¬´ ê¸‰í•´ìš”! í™”ì¥ì‹¤ ê¸‰í•´ìš”?",
                "ì´ˆë¡ë¹› ì•„ë‹ˆì–ì•„ìš” ğŸ˜…",
                "ì†ê°€ë½ì´ ë‡Œë¥¼ ì§€ë°°í–ˆêµ°ìš”.",
                "ì§„ì •í•´ ì¹œêµ¬â€¦"
            ];
            mainTxt.textContent = 'ë„ˆë¬´ ë¹¨ëì–´ìš”!';
            subTxt.textContent = msgs[Math.floor(Math.random()*msgs.length)] + ' (í´ë¦­í•´ì„œ ë‹¤ì‹œ)';

            setTimeout(() => zone.classList.remove('shake'), 350);
        }

        function success(){
            const t = Math.max(0, Math.floor(performance.now() - startTime));
            records.push(t);
            updateHUD(t);

            badge.classList.remove('pulse');

            if(records.length >= maxRounds){
                finish();
                return;
            }

            state = 'waiting';
            softLock();

            setZoneState('state-waiting');
            badge.textContent = 'â±ï¸';
            mainTxt.textContent = `${t} ms!`;
            subTxt.textContent = 'í´ë¦­í•´ì„œ ë‹¤ìŒ ë¼ìš´ë“œ';
        }

        function finish(){
            const a = avg();

            let e = "ğŸ¢";
            let c = "í˜¹ì‹œâ€¦ ì£¼ë¬´ì‹œê³  ê³„ì‹ ê°€ìš”?";
            if(a < 200){ e="âš¡"; c="ë‹¹ì‹ ì€ ì¸ê°„ì´ ì•„ë‹™ë‹ˆë‹¤. ë¹›ì˜ ì†ë„!"; }
            else if(a < 250){ e="ğŸ¦…"; c="í”„ë¡œê²Œì´ë¨¸ê¸‰ ìˆœë°œë ¥!"; }
            else if(a < 300){ e="ğŸ™‚"; c="ë¬´ë‚œí•˜ê²Œ ë¹ ë¦…ë‹ˆë‹¤. í‰ê·  ì´ìƒ!"; }
            else if(a < 400){ e="ğŸŒ"; c="ë°˜ì‘ì´ ì¡°ê¸ˆ ëŠë ¤ìš”. ì»¨ë””ì…˜ ì²´í¬!"; }
            else { e="ğŸ¦¥"; c="ë‚˜ë¬´ëŠ˜ë³´ê°€ ì¹œêµ¬í•˜ìê³  í•˜ê² ì–´ìš”."; }

            emoji.textContent = e;
            finalAvg.textContent = a.toString();
            comment.textContent = c;

            overlay.style.display = 'flex';
            state = 'done';
        }

        function reset(){
            clearTimers();
            state = 'waiting';
            records = [];
            startTime = 0;
            lock = false;

            overlay.style.display = 'none';
            setZoneState('state-waiting');
            badge.textContent = 'ğŸ–±ï¸';
            badge.classList.remove('pulse');
            mainTxt.textContent = 'í´ë¦­í•´ì„œ ì‹œì‘í•˜ê¸°';
            subTxt.textContent = 'ê¸´ì¥ í‘¸ì‹œê³ â€¦';

            updateHUD(null);
        }

        function handleAction(){
            if(lock) return;

            if(state === 'waiting') return startReady();
            if(state === 'ready') return failTooSoon();
            if(state === 'go') return success();
            if(state === 'error') return startReady();
        }

        // pointer/click
        zone.addEventListener('pointerdown', (e) => {
            e.preventDefault();
            handleAction();
        });

        // í‚¤ë³´ë“œ(ì„ íƒ): ìŠ¤í˜ì´ìŠ¤/ì—”í„°ë¡œë„ í´ë¦­ ì²˜ë¦¬
        zone.addEventListener('keydown', (e) => {
            if(e.key === 'Enter' || e.key === ' '){
                e.preventDefault();
                handleAction();
            }
        });

        retryBtn.addEventListener('click', reset);
        closeBtn.addEventListener('click', () => {
            overlay.style.display = 'none';
            // ë‹«ê¸° í›„ ì¬ë„ì „ ìœ ë„
            state = 'waiting';
            setZoneState('state-waiting');
            badge.textContent = 'ğŸ–±ï¸';
            mainTxt.textContent = 'í´ë¦­í•´ì„œ ì‹œì‘í•˜ê¸°';
            subTxt.textContent = 'ê¸´ì¥ í‘¸ì‹œê³ â€¦';
        });

        reset();
    })();
</script>
</body>
</html>