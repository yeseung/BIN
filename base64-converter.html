<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <title>Base64 ì¸ì½”ë”©Â·ë””ì½”ë”© â€“ ë¬¸ìì—´Â·íŒŒì¼Â·ì´ë¯¸ì§€ ë³€í™˜ ë„êµ¬</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
        * { box-sizing: border-box; }
        body {
            margin: 0;
            padding: 24px;
            font-family: -apple-system, BlinkMacSystemFont,"Malgun Gothic",system-ui,sans-serif;
            background: #f4f5f7;
            color: #111827;
        }
        .page {
            max-width: 1100px;
            margin: 0 auto;
        }
        h1 {
            margin: 0 0 10px;
            font-size: 28px;
            font-weight: 800;
        }
        .subtitle {
            margin: 0 0 24px;
            font-size: 14px;
            color: #6b7280;
            line-height: 1.7;
        }

        .card {
            background: #ffffff;
            border-radius: 16px;
            padding: 20px 20px 24px;
            box-shadow: 0 8px 24px rgba(15,23,42,0.06);
        }

        /* íƒ­ ì˜ì—­ */
        .tab-row {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
            margin-bottom: 18px;
        }
        .tab-btn {
            flex: 1 1 0;
            border: none;
            border-radius: 999px;
            padding: 10px 14px;
            font-size: 14px;
            background: #e5e7eb;
            color: #374151;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            transition: background 0.15s, color 0.15s, box-shadow 0.15s, transform 0.05s;
            white-space: nowrap;
        }
        .tab-btn span.icon {
            font-size: 16px;
        }
        .tab-btn.active {
            background: #2563eb;
            color: #ffffff;
            box-shadow: 0 2px 8px rgba(37,99,235,0.45);
        }
        .tab-btn:active {
            transform: translateY(1px);
        }

        .mode {
            display: none;
        }
        .mode.active {
            display: block;
        }

        .area-label {
            font-size: 13px;
            color: #4b5563;
            margin-bottom: 6px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .area-label small {
            color: #9ca3af;
        }

        textarea {
            width: 100%;
            min-height: 180px;
            resize: vertical;
            padding: 12px 14px;
            border-radius: 10px;
            border: 1px solid #d1d5db;
            font-family: Menlo,Consolas,"SF Mono",monospace;
            font-size: 13px;
            line-height: 1.5;
            outline: none;
            background: #f9fafb;
            transition: border-color 0.15s, box-shadow 0.15s, background 0.15s;
        }
        textarea:focus {
            border-color: #2563eb;
            background: #ffffff;
            box-shadow: 0 0 0 1px #2563eb33;
        }
        textarea[readonly] {
            background: #f3f4f6;
        }

        .options-row {
            display: flex;
            flex-wrap: wrap;
            gap: 12px 16px;
            align-items: center;
            margin: 14px 0 18px;
            font-size: 13px;
            color: #4b5563;
        }

        /* ì²´í¬ë°•ìŠ¤ */
        .chk {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
        }
        .chk input {
            width: 14px;
            height: 14px;
            margin: 0;
            accent-color: #2563eb;
        }

        /* í† ê¸€ ìŠ¤ìœ„ì¹˜ */
        .toggle {
            position: relative;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
            user-select: none;
        }
        .toggle-input {
            position: absolute;
            opacity: 0;
            pointer-events: none;
        }
        .toggle-track {
            width: 32px;
            height: 18px;
            border-radius: 999px;
            background: #d1d5db;
            position: relative;
            transition: background 0.15s;
        }
        .toggle-thumb {
            position: absolute;
            top: 2px;
            left: 3px;
            width: 14px;
            height: 14px;
            border-radius: 999px;
            background: #ffffff;
            box-shadow: 0 1px 3px rgba(0,0,0,0.25);
            transition: transform 0.16s cubic-bezier(0.4,0,0.2,1);
        }
        .toggle-input:checked + .toggle-track {
            background: #2563eb;
        }
        .toggle-input:checked + .toggle-track .toggle-thumb {
            transform: translateX(12px);
        }
        .toggle-text {
            font-size: 13px;
            color: #4b5563;
        }

        /* ì…€ë ‰íŠ¸ */
        .select-wrap {
            position: relative;
            display: inline-block;
        }
        .select {
            padding: 6px 28px 6px 10px;
            border-radius: 999px;
            border: 1px solid #d1d5db;
            background: #f9fafb;
            font-size: 13px;
            outline: none;
            appearance: none;
            min-width: 100px;
        }
        .select-wrap::after {
            content: "â–¾";
            position: absolute;
            right: 9px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 11px;
            color: #6b7280;
            pointer-events: none;
        }

        .btn-row {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 8px;
        }
        .btn {
            border: none;
            border-radius: 999px;
            padding: 9px 18px;
            font-size: 14px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            white-space: nowrap;
            transition: background 0.15s, box-shadow 0.15s, transform 0.05s;
        }
        .btn-primary {
            background: #2563eb;
            color: #ffffff;
            box-shadow: 0 2px 6px rgba(37,99,235,0.45);
        }
        .btn-primary:hover { background:#1d4ed8; }
        .btn-primary:active {
            transform: translateY(1px);
            box-shadow: 0 1px 3px rgba(37,99,235,0.4);
        }
        .btn-ghost {
            background: #e5e7eb;
            color: #374151;
        }
        .btn-ghost:hover { background:#d1d5db; }

        .result-label {
            margin-top: 18px;
            margin-bottom: 6px;
            font-size: 13px;
            color: #4b5563;
        }

        .info-text {
            margin-top: 10px;
            font-size: 12px;
            color: #9ca3af;
            line-height: 1.6;
        }

        /* íŒŒì¼ ëª¨ë“œ */
        .file-box {
            padding: 14px;
            border-radius: 12px;
            border: 1px dashed #cbd5f5;
            background: #f9fafb;
            margin-bottom: 10px;
        }
        .file-row {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: center;
            font-size: 13px;
        }
        .file-row input[type="file"] {
            font-size: 13px;
        }
        .preview {
            margin-top: 10px;
            font-size: 12px;
            color: #6b7280;
        }
        .preview img {
            max-width: 260px;
            max-height: 160px;
            border-radius: 8px;
            display: block;
            margin-top: 6px;
            border: 1px solid #e5e7eb;
        }
        .download-link {
            margin-top: 8px;
            font-size: 13px;
        }
        .download-link a {
            color: #2563eb;
            text-decoration: none;
            font-weight: 500;
        }

        @media (max-width: 640px) {
            body { padding: 16px; }
            h1 { font-size: 22px; }
        }
    </style>
</head>
<body>
<div class="page">
    <h1>Base64 ì¸ì½”ë”©Â·ë””ì½”ë”© â€“ ë¬¸ìì—´Â·íŒŒì¼Â·ì´ë¯¸ì§€ ë³€í™˜ ë¬´ë£Œ ë„êµ¬</h1>
    <p class="subtitle">
        ë¬¸ìì—´ê³¼ íŒŒì¼ì„ Base64 í˜•ì‹ìœ¼ë¡œ ë¹ ë¥´ê²Œ ì¸ì½”ë”©í•˜ê±°ë‚˜ ë””ì½”ë”©í•  ìˆ˜ ìˆëŠ” ì˜¨ë¼ì¸ ë„êµ¬ì…ë‹ˆë‹¤.
        í…ìŠ¤íŠ¸ëŠ” ë¬¼ë¡  ì´ë¯¸ì§€ íŒŒì¼ë„ ì§€ì›í•˜ë©°, ë¸Œë¼ìš°ì €ì˜ UTF-8 ì¸ì½”ë”©ì„ ê¸°ì¤€ìœ¼ë¡œ ë™ì‘í•©ë‹ˆë‹¤.
        ì´ë©”ì¼ ì²¨ë¶€, ë°ì´í„° URI, ì´ë¯¸ì§€ ë³€í™˜ ë“± ì›¹ ê°œë°œê³¼ ë°ì´í„° ì²˜ë¦¬ì— í™œìš©í•´ ë³´ì„¸ìš”.
    </p>

    <div class="card">
        <div class="tab-row" role="tablist">
            <button class="tab-btn active" data-target="text-encode" type="button">
                <span class="icon">ğŸ”</span><span>Base64 ì¸ì½”ë”©</span>
            </button>
            <button class="tab-btn" data-target="text-decode" type="button">
                <span class="icon">ğŸ”“</span><span>Base64 ë””ì½”ë”©</span>
            </button>
            <button class="tab-btn" data-target="file-encode" type="button">
                <span class="icon">ğŸ“</span><span>Base64 íŒŒì¼ ì¸ì½”ë”©</span>
            </button>
            <button class="tab-btn" data-target="file-decode" type="button">
                <span class="icon">ğŸ“¥</span><span>Base64 íŒŒì¼ ë””ì½”ë”©</span>
            </button>
        </div>

        <!-- ë¬¸ìì—´ ì¸ì½”ë”© -->
        <section class="mode active" id="mode-text-encode">
            <div class="area-label">
                <span>ì¸ì½”ë”©í•  ë¬¸ìì—´ì„ ë¶™ì—¬ ë„£ìœ¼ì„¸ìš”.</span>
                <small>ì¼ë°˜ í…ìŠ¤íŠ¸ â†’ Base64 ë¬¸ìì—´</small>
            </div>
            <textarea id="text-input-encode" placeholder="ì˜ˆ) ì•ˆë…•í•˜ì„¸ìš”, Base64 í…ŒìŠ¤íŠ¸ì…ë‹ˆë‹¤."></textarea>

            <div class="options-row">


                <label class="toggle">
                    <input class="toggle-input" type="checkbox" id="trim-encode" checked />
                    <span class="toggle-track"><span class="toggle-thumb"></span></span>
                    <span class="toggle-text">ì•ë’¤ ê³µë°± ì œê±°</span>
                </label>
            </div>

            <div class="btn-row">
                <button class="btn btn-primary" id="btn-encode-text" type="button">â–¶ Base64 ì¸ì½”ë”© í•˜ê¸°</button>
                <button class="btn btn-ghost" id="btn-encode-clear" type="button">âŸ² ì´ˆê¸°í™”</button>
            </div>

            <div class="result-label">Base64 ì¸ì½”ë”© ê²°ê³¼</div>
            <textarea id="text-output-encode" readonly placeholder="ì—¬ê¸°ì— Base64 ê²°ê³¼ê°€ í‘œì‹œë©ë‹ˆë‹¤."></textarea>

            <p class="info-text">
                * ìœ ë‹ˆì½”ë“œ ë¬¸ìì—´ì€ <code>encodeURIComponent()</code> ì™€ <code>btoa()</code>ë¥¼ ì¡°í•©í•˜ì—¬ ì•ˆì „í•˜ê²Œ Base64ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.<br />
                * ì„ íƒí•œ ë¬¸ìì…‹ ì˜µì…˜ì€ ì„¤ëª…ìš©ì´ë©°, ì‹¤ì œ ë³€í™˜ì€ ë¸Œë¼ìš°ì €ì˜ UTF-8 ì¸ì½”ë”©ì„ ê¸°ì¤€ìœ¼ë¡œ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤.
            </p>
        </section>

        <!-- ë¬¸ìì—´ ë””ì½”ë”© -->
        <section class="mode" id="mode-text-decode">
            <div class="area-label">
                <span>ë””ì½”ë”©í•  Base64 ë¬¸ìì—´ì„ ë¶™ì—¬ ë„£ìœ¼ì„¸ìš”.</span>
                <small>Base64 ë¬¸ìì—´ â†’ ì¼ë°˜ í…ìŠ¤íŠ¸</small>
            </div>
            <textarea id="text-input-decode" placeholder="ì˜ˆ) 7JWI64WV7ZWY7IS47JqULCBCYXNlNjQgVGVzdA=="></textarea>

            <div class="options-row">
                <label class="chk">
                    <input type="checkbox" id="ignore-newline" checked />
                    <span>ê°œí–‰Â·ê³µë°± ìë™ ë¬´ì‹œ</span>
                </label>
            </div>

            <div class="btn-row">
                <button class="btn btn-primary" id="btn-decode-text" type="button">â–¶ Base64 ë””ì½”ë”© í•˜ê¸°</button>
                <button class="btn btn-ghost" id="btn-decode-clear" type="button">âŸ² ì´ˆê¸°í™”</button>
            </div>

            <div class="result-label">ë””ì½”ë”© ê²°ê³¼ í…ìŠ¤íŠ¸</div>
            <textarea id="text-output-decode" readonly placeholder="Base64 ë””ì½”ë”© ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤."></textarea>

            <p class="info-text">
                * ì˜ëª»ëœ Base64 ë¬¸ìì—´ì„ ë„£ìœ¼ë©´ ë””ì½”ë”© ì¤‘ ì˜¤ë¥˜ ë©”ì‹œì§€ê°€ í‘œì‹œë©ë‹ˆë‹¤.<br />
                * ê¸´ ë¬¸ìì—´ì„ ë³µì‚¬í•´ ë¶™ì—¬ ë„£ì„ ë•Œ ìƒê¸°ëŠ” ì¤„ë°”ê¿ˆÂ·ê³µë°±ì€ ê¸°ë³¸ì ìœ¼ë¡œ ë¬´ì‹œí•˜ë„ë¡ ì²˜ë¦¬í•©ë‹ˆë‹¤.
            </p>
        </section>

        <!-- íŒŒì¼ ì¸ì½”ë”© -->
        <section class="mode" id="mode-file-encode">
            <div class="area-label">
                <span>Base64ë¡œ ì¸ì½”ë”©í•  íŒŒì¼ì„ ì„ íƒí•˜ì„¸ìš”.</span>
                <small>ì´ë¯¸ì§€Â·ë¬¸ì„œÂ·í…ìŠ¤íŠ¸ íŒŒì¼ ë“± ìµœëŒ€ 5MB ê¶Œì¥</small>
            </div>

            <div class="file-box">
                <div class="file-row">
                    <input type="file" id="file-input-encode" />
                    <label class="chk">
                        <input type="checkbox" id="dataurl-toggle" checked />
                        <span>data:URL í˜•ì‹ìœ¼ë¡œ ì¶œë ¥ (ê¶Œì¥)</span>
                    </label>
                </div>
                <div class="preview" id="file-preview-encode">
                    ì„ íƒëœ íŒŒì¼ì´ ì´ë¯¸ì§€ì¸ ê²½ìš° ì•„ë˜ì— ë¯¸ë¦¬ë³´ê¸°ê°€ í‘œì‹œë©ë‹ˆë‹¤.
                </div>
            </div>

            <div class="btn-row">
                <button class="btn btn-primary" id="btn-encode-file" type="button">â–¶ íŒŒì¼ Base64 ì¸ì½”ë”©</button>
                <button class="btn btn-ghost" id="btn-encode-file-clear" type="button">âŸ² ì´ˆê¸°í™”</button>
            </div>

            <div class="result-label">íŒŒì¼ Base64 ì¸ì½”ë”© ê²°ê³¼</div>
            <textarea id="file-output-encode" readonly placeholder="ì„ íƒí•œ íŒŒì¼ì˜ Base64 ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤."></textarea>

            <p class="info-text">
                * ì´ë¯¸ì§€ì¸ ê²½ìš° <code>data:image/png;base64,...</code> ì™€ ê°™ì€ Data URI í˜•ì‹ìœ¼ë¡œ ì¶œë ¥ë©ë‹ˆë‹¤.<br />
                * â€œdata:URL í˜•ì‹ìœ¼ë¡œ ì¶œë ¥â€ì„ ë„ë©´ ìˆœìˆ˜ Base64 ë³¸ë¬¸ë§Œ ì¶œë ¥í•©ë‹ˆë‹¤.
            </p>
        </section>

        <!-- íŒŒì¼ ë””ì½”ë”© -->
        <section class="mode" id="mode-file-decode">
            <div class="area-label">
                <span>Base64 ë¬¸ìì—´ ë˜ëŠ” data:URL ì„ ë¶™ì—¬ ë„£ìœ¼ì„¸ìš”.</span>
                <small>Base64 â†’ íŒŒì¼ ë‹¤ìš´ë¡œë“œ</small>
            </div>

            <textarea id="file-input-decode" placeholder="ì˜ˆ) data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAA... ë˜ëŠ” ìˆœìˆ˜ Base64 ë¬¸ìì—´"></textarea>

            <div class="options-row">
                <label class="chk">
                    <input type="checkbox" id="guess-image" checked />
                    <span>ì´ë¯¸ì§€ë©´ ìë™ ë¯¸ë¦¬ë³´ê¸°</span>
                </label>
                <label class="chk">
                    <span>íŒŒì¼ ì´ë¦„:</span>
                    <input type="text" id="filename-input" placeholder="decoded-file" style="padding:4px 8px;border-radius:8px;border:1px solid #d1d5db;font-size:13px;min-width:120px;">
                </label>
            </div>

            <div class="btn-row">
                <button class="btn btn-primary" id="btn-decode-file" type="button">â–¶ Base64 íŒŒì¼ ìƒì„±</button>
                <button class="btn btn-ghost" id="btn-decode-file-clear" type="button">âŸ² ì´ˆê¸°í™”</button>
            </div>

            <div class="download-link" id="download-area"></div>
            <div class="preview" id="file-preview-decode"></div>

            <p class="info-text">
                * data:URL í˜•ì‹(<code>data:image/png;base64,...</code>)ì„ ë„£ìœ¼ë©´ MIME íƒ€ì…ì„ ìë™ ì¸ì‹í•©ë‹ˆë‹¤.<br />
                * ìˆœìˆ˜ Base64 ë¬¸ìì—´ë§Œ ìˆì„ ê²½ìš° ê¸°ë³¸ íƒ€ì…ì€ <code>application/octet-stream</code> ìœ¼ë¡œ ì €ì¥ë©ë‹ˆë‹¤.
            </p>
        </section>
    </div>
</div>

<script>
    // íƒ­ ì „í™˜
    (function () {
        const tabs = document.querySelectorAll(".tab-btn");
        const modes = {
            "text-encode": document.getElementById("mode-text-encode"),
            "text-decode": document.getElementById("mode-text-decode"),
            "file-encode": document.getElementById("mode-file-encode"),
            "file-decode": document.getElementById("mode-file-decode")
        };

        tabs.forEach(btn => {
            btn.addEventListener("click", () => {
                const target = btn.getAttribute("data-target");

                tabs.forEach(b => b.classList.remove("active"));
                btn.classList.add("active");

                Object.keys(modes).forEach(key => {
                    modes[key].classList.toggle("active", key === target);
                });
            });
        });
    })();

    // ë¬¸ìì—´ Base64 ìœ í‹¸
    function base64EncodeUnicode(str) {
        const utf8 = encodeURIComponent(str).replace(/%([0-9A-F]{2})/g, (_, p1) =>
            String.fromCharCode("0x" + p1)
        );
        return btoa(utf8);
    }

    function base64DecodeUnicode(b64) {
        const binary = atob(b64);
        let result = "";
        const len = binary.length;
        for (let i = 0; i < len; i++) {
            const hex = binary.charCodeAt(i).toString(16).padStart(2, "0");
            result += "%" + hex;
        }
        return decodeURIComponent(result);
    }

    // ë¬¸ìì—´ ì¸ì½”ë”© ëª¨ë“œ
    (function () {
        const input = document.getElementById("text-input-encode");
        const output = document.getElementById("text-output-encode");
        const trimCheckbox = document.getElementById("trim-encode");
        const btnRun = document.getElementById("btn-encode-text");
        const btnReset = document.getElementById("btn-encode-clear");

        function run() {
            let text = input.value || "";
            if (trimCheckbox.checked) text = text.trim();
            if (!text) {
                output.value = "";
                return;
            }
            try {
                output.value = base64EncodeUnicode(text);
            } catch (e) {
                output.value =
                    "ì¸ì½”ë”© ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\n\n" +
                    (e && e.message ? e.message : String(e));
            }
        }

        btnRun.addEventListener("click", run);
        btnReset.addEventListener("click", () => {
            input.value = "";
            output.value = "";
        });

        // Ctrl+Enter / Cmd+Enter ì‹¤í–‰
        input.addEventListener("keydown", (e) => {
            if ((e.ctrlKey || e.metaKey) && e.key === "Enter") {
                e.preventDefault();
                run();
            }
        });
    })();

    // ë¬¸ìì—´ ë””ì½”ë”© ëª¨ë“œ
    (function () {
        const input = document.getElementById("text-input-decode");
        const output = document.getElementById("text-output-decode");
        const ignoreNewline = document.getElementById("ignore-newline");
        const btnRun = document.getElementById("btn-decode-text");
        const btnReset = document.getElementById("btn-decode-clear");

        function run() {
            let text = input.value || "";
            if (ignoreNewline.checked) {
                text = text.replace(/\s+/g, "");
            }
            if (!text) {
                output.value = "";
                return;
            }
            try {
                output.value = base64DecodeUnicode(text);
            } catch (e) {
                output.value =
                    "ë””ì½”ë”© ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\n\n" +
                    (e && e.message ? e.message : String(e));
            }
        }

        btnRun.addEventListener("click", run);
        btnReset.addEventListener("click", () => {
            input.value = "";
            output.value = "";
        });

        input.addEventListener("keydown", (e) => {
            if ((e.ctrlKey || e.metaKey) && e.key === "Enter") {
                e.preventDefault();
                run();
            }
        });
    })();

    // íŒŒì¼ ì¸ì½”ë”©
    (function () {
        const fileInput = document.getElementById("file-input-encode");
        const output = document.getElementById("file-output-encode");
        const previewBox = document.getElementById("file-preview-encode");
        const btnRun = document.getElementById("btn-encode-file");
        const btnReset = document.getElementById("btn-encode-file-clear");
        const dataurlToggle = document.getElementById("dataurl-toggle");

        fileInput.addEventListener("change", () => {
            previewBox.innerHTML = "ì„ íƒëœ íŒŒì¼: ì—†ìŒ";
            const file = fileInput.files && fileInput.files[0];
            if (!file) {
                previewBox.textContent = "ì„ íƒëœ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.";
                return;
            }
            previewBox.textContent = `ì„ íƒëœ íŒŒì¼: ${file.name} (${Math.round(
                file.size / 1024
            )} KB)`;
            if (file.type.startsWith("image/")) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    const img = document.createElement("img");
                    img.src = e.target.result;
                    previewBox.appendChild(img);
                };
                reader.readAsDataURL(file);
            }
        });

        function run() {
            const file = fileInput.files && fileInput.files[0];
            if (!file) {
                alert("ë¨¼ì € ì¸ì½”ë”©í•  íŒŒì¼ì„ ì„ íƒí•´ ì£¼ì„¸ìš”.");
                return;
            }
            const reader = new FileReader();
            reader.onload = (e) => {
                const dataUrl = e.target.result;
                if (dataurlToggle.checked) {
                    output.value = dataUrl;
                } else {
                    const commaIndex = dataUrl.indexOf(",");
                    output.value = commaIndex >= 0 ? dataUrl.slice(commaIndex + 1) : dataUrl;
                }
            };
            reader.onerror = () => {
                output.value = "íŒŒì¼ì„ ì½ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";
            };
            reader.readAsDataURL(file);
        }

        btnRun.addEventListener("click", run);
        btnReset.addEventListener("click", () => {
            fileInput.value = "";
            output.value = "";
            previewBox.textContent =
                "ì„ íƒëœ íŒŒì¼ì´ ì´ë¯¸ì§€ì¸ ê²½ìš° ì•„ë˜ì— ë¯¸ë¦¬ë³´ê¸°ê°€ í‘œì‹œë©ë‹ˆë‹¤.";
            previewBox.querySelectorAll("img").forEach((img) => img.remove());
        });
    })();

    // íŒŒì¼ ë””ì½”ë”©
    (function () {
        const input = document.getElementById("file-input-decode");
        const preview = document.getElementById("file-preview-decode");
        const downloadArea = document.getElementById("download-area");
        const btnRun = document.getElementById("btn-decode-file");
        const btnReset = document.getElementById("btn-decode-file-clear");
        const guessImage = document.getElementById("guess-image");
        const filenameInput = document.getElementById("filename-input");

        let currentUrl;

        function clearObjectUrl() {
            if (currentUrl) {
                URL.revokeObjectURL(currentUrl);
                currentUrl = null;
            }
        }

        function run() {
            clearObjectUrl();
            preview.innerHTML = "";
            downloadArea.textContent = "";

            let value = (input.value || "").trim();
            if (!value) {
                alert("Base64 ë¬¸ìì—´ ë˜ëŠ” data:URL ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.");
                return;
            }

            let mime = "application/octet-stream";
            let base64 = value;

            if (value.startsWith("data:")) {
                const parts = value.split(",");
                if (parts.length < 2) {
                    alert("data:URL í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.");
                    return;
                }
                const meta = parts[0];
                base64 = parts.slice(1).join(",");
                const match = meta.match(/^data:([^;]+);base64$/i);
                if (match) mime = match[1];
            } else {
                // ê³µë°±/ê°œí–‰ ì œê±°
                base64 = value.replace(/\s+/g, "");
            }

            try {
                const binary = atob(base64);
                const len = binary.length;
                const bytes = new Uint8Array(len);
                for (let i = 0; i < len; i++) {
                    bytes[i] = binary.charCodeAt(i);
                }
                const blob = new Blob([bytes], { type: mime });
                currentUrl = URL.createObjectURL(blob);

                // íŒŒì¼ ì´ë¦„ ì„¤ì •
                let baseName = filenameInput.value.trim() || "decoded-file";
                let ext = "";
                if (mime.includes("/")) {
                    const sub = mime.split("/")[1];
                    if (sub && sub !== "octet-stream") {
                        ext = "." + sub.replace(/[^a-z0-9]+/gi, "");
                    }
                }
                const fileName = baseName + ext;

                const link = document.createElement("a");
                link.href = currentUrl;
                link.download = fileName;
                link.textContent = `ğŸ“¥ ${fileName} ë‹¤ìš´ë¡œë“œ`;
                downloadArea.innerHTML = "";
                downloadArea.appendChild(link);

                if (guessImage.checked && mime.startsWith("image/")) {
                    const img = document.createElement("img");
                    img.src = currentUrl;
                    preview.textContent = "ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸°:";
                    preview.appendChild(img);
                } else {
                    preview.textContent = "ë””ì½”ë”©ëœ íŒŒì¼ì„ ìœ„ ë§í¬ë¥¼ í†µí•´ ì €ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.";
                }
            } catch (e) {
                clearObjectUrl();
                preview.textContent = "";
                downloadArea.textContent =
                    "ë””ì½”ë”© ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: " +
                    (e && e.message ? e.message : String(e));
            }
        }

        btnRun.addEventListener("click", run);
        btnReset.addEventListener("click", () => {
            clearObjectUrl();
            input.value = "";
            preview.innerHTML = "";
            downloadArea.textContent = "";
            filenameInput.value = "";
        });
    })();
</script>
</body>
</html>
