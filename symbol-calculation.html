<!-- filename example: symbol-calculation.html -->
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <title>ê¸°í˜¸ ê³„ì‚° í…ŒìŠ¤íŠ¸</title>
    <meta name="description" content="íŠ¹ìˆ˜ë¬¸ì(ì´ëª¨ì§€)ì™€ ëŒ€ì‘ë˜ëŠ” ìˆ«ìë¥¼ í™•ì¸í•´ì„œ ê³„ì‚°í•˜ëŠ” ë‘ë‡Œ í›ˆë ¨ í…ŒìŠ¤íŠ¸" />

    <!-- https://www.jiraksil.com/service/spcalculation -->

    <style>
        :root{
            --bg:#f6f7fb;
            --card:#ffffff;
            --text:#111827;
            --muted:#6b7280;
            --border:#e5e7eb;
            --shadow:0 14px 36px rgba(0,0,0,.08);
            --radius:16px;

            --primary:#2563eb;
            --primary2:#1d4ed8;

            --good:#16a34a;
            --bad:#dc2626;

            --chip:#f9fafb;
        }

        *{ box-sizing:border-box; }
        body{
            margin:0;
            font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Noto Sans KR",sans-serif;
            background:var(--bg);
            color:var(--text);
        }

        .wrap{
            max-width:980px;
            margin:40px auto;
            padding:20px;
        }

        h1{
            margin:0;
            font-size:22px;
            line-height:1.25;
        }

        .desc{
            margin:10px 0 0;
            color:var(--muted);
            line-height:1.65;
            max-width:75ch;
        }

        .card{
            margin-top:14px;
            background:var(--card);
            border:1px solid var(--border);
            border-radius:var(--radius);
            box-shadow:var(--shadow);
            overflow:hidden;
        }

        .topbar{
            display:flex;
            align-items:center;
            justify-content:space-between;
            gap:12px;
            flex-wrap:wrap;
            padding:14px 16px;
            border-bottom:1px solid var(--border);
            background:#fff;
        }

        .chips{
            display:flex;
            gap:10px;
            flex-wrap:wrap;
            align-items:center;
            font-weight:900;
        }
        .chip{
            display:inline-flex;
            gap:8px;
            align-items:center;
            padding:8px 12px;
            background:var(--chip);
            border:1px solid var(--border);
            border-radius:999px;
            font-size:14px;
            user-select:none;
            white-space:nowrap;
        }
        .chip span{ color:var(--muted); font-weight:900; }

        .btns{ display:flex; gap:10px; flex-wrap:wrap; }
        .btn{
            appearance:none;
            border:1px solid var(--border);
            background:#fff;
            color:var(--text);
            border-radius:999px;
            padding:10px 14px;
            font-weight:1000;
            cursor:pointer;
            transition:transform .05s ease, border-color .2s ease, background .2s ease, opacity .2s ease;
            user-select:none;
            white-space:nowrap;
        }
        .btn:hover{ border-color:#cbd5e1; }
        .btn:active{ transform:translateY(1px); }
        .btn.primary{
            background:var(--primary);
            border-color:var(--primary);
            color:#fff;
        }
        .btn.primary:hover{
            background:var(--primary2);
            border-color:var(--primary2);
        }
        .btn:disabled{ opacity:.55; cursor:not-allowed; }

        .stage{
            padding:16px;
        }

        .layout{
            display:grid;
            grid-template-columns: 1fr;
            gap:14px;
            align-items:start;
        }
        @media (min-width:920px){
            .layout{
                grid-template-columns: 1fr 360px;
            }
            .right{
                position:sticky;
                top:16px;
            }
        }

        .panel{
            border:1px solid var(--border);
            border-radius:14px;
            background:#fff;
            overflow:hidden;
        }

        .panelHead{
            padding:14px 16px;
            border-bottom:1px solid var(--border);
            display:flex;
            align-items:center;
            justify-content:space-between;
            gap:10px;
            flex-wrap:wrap;
        }
        .panelHead .title{
            font-weight:1000;
        }
        .panelHead .hint{
            color:var(--muted);
            font-size:13px;
        }

        .mapping{
            padding:16px;
            display:grid;
            grid-template-columns: repeat(5, minmax(0, 1fr));
            gap:10px;
        }
        @media (max-width:520px){
            .mapping{ grid-template-columns: repeat(4, minmax(0, 1fr)); }
        }

        .mapBox{
            border:1px solid var(--border);
            border-radius:12px;
            padding:10px 8px;
            text-align:center;
            user-select:none;
            background:#fff;
            min-height:64px;
            display:flex;
            flex-direction:column;
            justify-content:center;
            gap:6px;
        }
        .mapNum{
            font-weight:1000;
            font-size:14px;
            color:var(--muted);
            line-height:1;
        }
        .mapSym{
            font-weight:1000;
            font-size:20px;
            line-height:1;
        }

        .expr{
            padding:16px;
            border-top:1px solid var(--border);
            background:#fff;
        }
        .exprLabel{
            color:var(--muted);
            font-size:13px;
            margin-bottom:8px;
        }
        .exprText{
            font-size:26px;
            font-weight:1000;
            line-height:1.2;
            letter-spacing:.5px;
            min-height:34px;
            word-break:break-word;
            position:relative;
        }

        .answer{
            padding:14px 16px 16px;
            border-top:1px solid var(--border);
            display:flex;
            gap:10px;
            flex-wrap:wrap;
            align-items:center;
            background:#fff;
        }

        .input{
            flex:1 1 200px;
            min-width:180px;
            padding:12px 14px;
            border:1px solid var(--border);
            border-radius:12px;
            font-size:16px;
            outline:none;
            text-align:center;
        }
        .input:focus{
            border-color:#93c5fd;
            box-shadow:0 0 0 4px rgba(37,99,235,.12);
        }

        .feedback{
            padding:0 16px 14px;
            display:none;
            font-weight:1000;
            font-size:14px;
            background:#fff;
        }
        .feedback.good{ color:var(--good); }
        .feedback.bad{ color:var(--bad); }

        /* overlay */
        .overlay{
            position:fixed;
            inset:0;
            background:rgba(2,6,23,.55);
            display:flex;
            align-items:center;
            justify-content:center;
            padding:18px;
            z-index:9999;
        }
        .overlay.hidden{ display:none; }
        .overlayCard{
            width:min(440px, 100%);
            background:#fff;
            border:1px solid var(--border);
            border-radius:16px;
            box-shadow:var(--shadow);
            padding:16px;
            text-align:center;
        }
        .overlayTitle{
            margin:0 0 8px;
            font-size:18px;
            font-weight:1000;
        }
        .overlayText{
            margin:0;
            color:var(--muted);
            line-height:1.65;
            font-size:14px;
        }
        .overlayActions{
            margin-top:14px;
            display:flex;
            justify-content:center;
            gap:10px;
            flex-wrap:wrap;
        }

        .toast{
            position:fixed;
            left:50%;
            bottom:22px;
            transform:translateX(-50%);
            background:#111827;
            color:#fff;
            padding:10px 14px;
            border-radius:999px;
            font-weight:900;
            font-size:13px;
            opacity:0;
            pointer-events:none;
            transition:opacity .2s ease, transform .2s ease;
            z-index:10000;
            box-shadow:0 10px 30px rgba(0,0,0,.25);
        }
        .toast.show{
            opacity:1;
            transform:translateX(-50%) translateY(-4px);
        }

        /* correct animation + particles */
        @keyframes correctPop {
            0%{ transform:scale(1); }
            45%{ transform:scale(1.12); }
            100%{ transform:scale(1); }
        }
        .pop{
            animation: correctPop .35s ease-in-out;
        }

        @keyframes particle {
            0%{ opacity:1; transform:translate(-50%,-50%) scale(1) rotate(0deg); }
            100%{ opacity:0; transform:translate(calc(-50% + var(--dx)), calc(-50% + var(--dy))) scale(.2) rotate(360deg); }
        }
        .particle{
            position:absolute;
            left:50%;
            top:50%;
            width:10px;
            height:10px;
            border-radius:999px;
            background:currentColor;
            opacity:0;
            animation: particle .7s ease-out forwards;
            pointer-events:none;
        }

        .note{
            margin-top:10px;
            color:var(--muted);
            font-size:13px;
            line-height:1.6;
        }
    </style>
</head>

<body>
<div class="wrap">
    <h1>ê¸°í˜¸ ê³„ì‚° í…ŒìŠ¤íŠ¸</h1>
    <p class="desc">
        ì•„ë˜ ë§¤í•‘í‘œì—ì„œ <b>ê¸°í˜¸(ì´ëª¨ì§€)</b>ê°€ ì˜ë¯¸í•˜ëŠ” <b>ìˆ«ì</b>ë¥¼ í™•ì¸í•˜ê³ , ê¸°í˜¸ë¡œ í‘œì‹œëœ ê³„ì‚°ì‹ì„ í’€ì–´ ì •ë‹µì„ ì…ë ¥í•˜ì„¸ìš”.
        (ì œí•œ ì‹œê°„ 60ì´ˆ)
    </p>

    <div class="card">
        <div class="topbar">
            <div class="chips">
                <div class="chip">ì‹œê°„ <span id="timer">60ì´ˆ</span></div>
                <div class="chip">ì ìˆ˜ <span id="score">0</span></div>
                <div class="chip">ë ˆë²¨ <span id="level">1</span></div>
            </div>
            <div class="btns">
                <button class="btn" id="newMapBtn" type="button" disabled>ë§¤í•‘ ìƒˆë¡œê³ ì¹¨</button>
                <button class="btn primary" id="startBtn" type="button">í…ŒìŠ¤íŠ¸ ì‹œì‘</button>
            </div>
        </div>

        <div class="stage">
            <div class="layout">
                <div class="panel">
                    <div class="panelHead">
                        <div class="title">ìˆ«ì â†” ê¸°í˜¸ ë§¤í•‘</div>
                        <div class="hint">ë¬¸ì œë§ˆë‹¤ ê¸°í˜¸ê°€ ë°”ë€ë‹ˆë‹¤</div>
                    </div>
                    <div class="mapping" id="mappingGrid"></div>

                    <div class="expr">
                        <div class="exprLabel">ê³„ì‚°ì‹</div>
                        <div class="exprText" id="expressionText">â€”</div>
                        <div class="note">íŒ: ê¸°í˜¸ëŠ” ìˆ«ì 0~9ì—ë§Œ ëŒ€ì‘í•©ë‹ˆë‹¤. ì—¬ëŸ¬ ìë¦¬ ìˆ«ìëŠ” ê¸°í˜¸ê°€ ì´ì–´ì ¸ í‘œì‹œë©ë‹ˆë‹¤.</div>
                    </div>
                </div>

                <div class="panel right">
                    <div class="panelHead">
                        <div class="title">ì •ë‹µ ì…ë ¥</div>
                        <div class="hint">Enter ë¡œ ì œì¶œ</div>
                    </div>
                    <div class="answer">
                        <input class="input" id="answerInput" type="number" placeholder="ì •ë‹µ" inputmode="numeric" disabled />
                        <button class="btn primary" id="submitBtn" type="button" disabled>í™•ì¸</button>
                    </div>
                    <div class="feedback" id="feedback"></div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- overlays -->
<div class="overlay" id="startOverlay">
    <div class="overlayCard">
        <div class="overlayTitle">ê¸°í˜¸ ê³„ì‚° ë¸Œë ˆì¸ íŠ¸ë ˆì´ë‹</div>
        <p class="overlayText">
            ì‚¼ì„±ì„œìš¸ë³‘ì› ë‡Œì‹ ê²½ì„¼í„°ì—ì„œ ì†Œê°œëœ ë°©ì‹ì²˜ëŸ¼,<br />
            <b>ê¸°í˜¸ â†” ìˆ«ì</b> ë§¤í•‘ì„ ë³´ê³  ê³„ì‚°ì‹ì„ í’€ì–´ë³´ì„¸ìš”.
        </p>
        <div class="overlayActions">
            <button class="btn primary" id="overlayStartBtn" type="button">ì‹œì‘í•˜ê¸°</button>
        </div>
    </div>
</div>

<div class="overlay hidden" id="endOverlay">
    <div class="overlayCard">
        <div class="overlayTitle">í…ŒìŠ¤íŠ¸ ì¢…ë£Œ!</div>
        <p class="overlayText" id="finalScore">ì ìˆ˜: 0</p>
        <div class="overlayActions">
            <button class="btn primary" id="restartBtn" type="button">ë‹¤ì‹œí•˜ê¸°</button>
        </div>
    </div>
</div>

<div class="toast" id="toast">ì•Œë¦¼</div>

<script>
    (() => {
        /*********************
         * DOM
         *********************/
        const timerEl = document.getElementById('timer');
        const scoreEl = document.getElementById('score');
        const levelEl = document.getElementById('level');

        const startBtn = document.getElementById('startBtn');
        const newMapBtn = document.getElementById('newMapBtn');

        const gridEl = document.getElementById('mappingGrid');
        const exprEl = document.getElementById('expressionText');

        const answerInput = document.getElementById('answerInput');
        const submitBtn = document.getElementById('submitBtn');
        const feedbackEl = document.getElementById('feedback');

        const startOverlay = document.getElementById('startOverlay');
        const endOverlay = document.getElementById('endOverlay');
        const overlayStartBtn = document.getElementById('overlayStartBtn');
        const restartBtn = document.getElementById('restartBtn');
        const finalScoreEl = document.getElementById('finalScore');

        const toastEl = document.getElementById('toast');

        /*********************
         * Game data
         *********************/
        const symbols = [
            'â—','â˜†','â€»','â—‹','â– ','â™£','â˜','â™¥','âŠ™','ã‰¿',
            'âœ¿','â˜€','â˜','â˜‚','â˜…','â˜ƒ','âœˆ','âœ‰','â™ ','â™¨',
            'â˜˜','â˜¯','â˜®','â˜ª','âš¾','âš¡','âœŒ','â˜•','âœ',
            'ğŸ˜€','ğŸ˜‚','â¤ï¸','ğŸ‘','ğŸ‰','ğŸ˜','ğŸ¥³','ğŸ˜','ğŸ™Œ','ğŸ’¡',
            'ğŸš€','ğŸ¯','ğŸ”¥','ğŸŒŸ','ğŸ€','ğŸ§©','âš½','ğŸ“š','âœ¨','ğŸ¤–',
            'ğŸ¥°','ğŸ¤©','ğŸ¤“','ğŸ˜‡','ğŸ¤”','ğŸ¥º','ğŸ˜¤','ğŸ˜±','ğŸ¥µ','ğŸ¥¶'
        ];

        let numberToSymbol = {};
        let symbolToNumber = {};

        let score = 0;
        let level = 1;
        let timeLeft = 60;
        let timerId = null;
        let active = false;

        let currentAnswer = 0;

        /*********************
         * UI helpers
         *********************/
        function toast(msg){
            toastEl.textContent = msg;
            toastEl.classList.add('show');
            clearTimeout(toastEl._t);
            toastEl._t = setTimeout(()=>toastEl.classList.remove('show'), 900);
        }

        function setFeedback(text, ok){
            feedbackEl.textContent = text;
            feedbackEl.className = 'feedback ' + (ok ? 'good' : 'bad');
            feedbackEl.style.display = 'block';
            clearTimeout(feedbackEl._t);
            feedbackEl._t = setTimeout(()=>{ feedbackEl.style.display='none'; }, 850);
        }

        function showOverlay(el){ el.classList.remove('hidden'); }
        function hideOverlay(el){ el.classList.add('hidden'); }

        function setEnabled(on){
            answerInput.disabled = !on;
            submitBtn.disabled = !on;
            newMapBtn.disabled = !on;
        }

        /*********************
         * Core
         *********************/
        function shuffle(arr){
            const a = arr.slice();
            for(let i=a.length-1;i>0;i--){
                const j = Math.floor(Math.random()*(i+1));
                [a[i], a[j]] = [a[j], a[i]];
            }
            return a;
        }

        function assignMapping(){
            const pool = shuffle(symbols);
            numberToSymbol = {};
            symbolToNumber = {};
            for(let i=0;i<=9;i++){
                const sym = pool[i];
                numberToSymbol[i] = sym;
                symbolToNumber[sym] = i;
            }
            renderMapping();
        }

        function renderMapping(){
            gridEl.innerHTML = '';
            for(let i=0;i<=9;i++){
                const box = document.createElement('div');
                box.className = 'mapBox';
                box.innerHTML = `<div class="mapNum">${i}</div><div class="mapSym">${escapeHtml(numberToSymbol[i])}</div>`;
                gridEl.appendChild(box);
            }
        }

        function escapeHtml(s){
            return String(s)
            .replaceAll('&','&amp;')
            .replaceAll('<','&lt;')
            .replaceAll('>','&gt;')
            .replaceAll('"','&quot;')
            .replaceAll("'","&#39;");
        }

        function numToSymbols(num){
            return String(num).split('').map(d => numberToSymbol[Number(d)]).join('');
        }

        // ë ˆë²¨ì— ë§ëŠ” ë‚œì´ë„ ìƒì„± (ìŒìˆ˜ ë°©ì§€)
        function generateExpression(){
            // ë ˆë²¨ì´ ì˜¤ë¥¼ìˆ˜ë¡ í”¼ì—°ì‚°ì ìˆ˜ ì¦ê°€ (ìµœëŒ€ 5)
            const operandsCount = Math.min(2 + Math.floor(level / 2), 5);

            let answer = 0;
            let display = '';
            let first = true;

            for(let i=0;i<operandsCount;i++){
                let n;
                if(level <= 2){
                    n = randInt(0, 9);
                }else if(level <= 5){
                    n = Math.random() < 0.7 ? randInt(0, 9) : randInt(10, 99);
                }else{
                    n = randInt(10, 99);
                }

                if(first){
                    answer = n;
                    display = numToSymbols(n);
                    first = false;
                    continue;
                }

                // ì—°ì‚°ì ì„ íƒ: + ìš°ì„ , -ëŠ” ìŒìˆ˜ ë°©ì§€
                let op = Math.random() < 0.5 ? '+' : '-';
                if(op === '-' && answer <= 0){
                    op = '+';
                }
                if(op === '-' && n > answer){
                    n = randInt(0, answer); // 0~answer ë¡œ ì œí•œ
                }

                if(op === '+') answer += n;
                else answer -= n;

                display += ` ${op} ${numToSymbols(n)}`;
            }

            currentAnswer = answer;
            exprEl.textContent = display + ' = ?';
        }

        function randInt(min, max){
            return Math.floor(Math.random()*(max-min+1)) + min;
        }

        function spawnParticles(){
            // exprEl ì¤‘ì‹¬ì—ì„œ íŒŒí‹°í´ ìƒì„±
            const colors = ['#FF5733','#33FF57','#3357FF','#F333FF','#FF33A8','#33FFF5','#FFC300','#DAF7A6','#C70039','#900C3F'];
            const count = 18;

            for(let i=0;i<count;i++){
                const p = document.createElement('div');
                p.className = 'particle';
                p.style.color = colors[Math.floor(Math.random()*colors.length)];

                const dx = (Math.random()*120 - 60) + 'px';
                const dy = (Math.random()*120 - 80) + 'px';
                p.style.setProperty('--dx', dx);
                p.style.setProperty('--dy', dy);

                exprEl.appendChild(p);

                // force reflow -> start anim
                p.offsetHeight;
                p.style.opacity = '1';

                p.addEventListener('animationend', () => p.remove());
            }
        }

        function nextQuestion(withNewMap=true){
            if(withNewMap) assignMapping();
            generateExpression();
            answerInput.value = '';
            answerInput.focus();
        }

        function check(){
            if(!active) return;

            const v = answerInput.value.trim();
            if(!v){
                toast('ì •ë‹µì„ ì…ë ¥í•˜ì„¸ìš”');
                answerInput.focus();
                return;
            }
            const user = Number(v);
            if(Number.isNaN(user)){
                toast('ìˆ«ìë¥¼ ì…ë ¥í•˜ì„¸ìš”');
                return;
            }

            if(user === currentAnswer){
                score += 1;
                level += 1;
                scoreEl.textContent = String(score);
                levelEl.textContent = String(level);

                setFeedback('ì •ë‹µ!', true);

                exprEl.classList.remove('pop');
                void exprEl.offsetWidth; // reflow
                exprEl.classList.add('pop');
                spawnParticles();
            }else{
                setFeedback('ì˜¤ë‹µ!', false);
            }

            // ë‹¤ìŒ ë¬¸ì œ(ë§¤í•‘ë„ ìƒˆë¡œ)
            setTimeout(()=>nextQuestion(true), 220);
        }

        function tick(){
            timeLeft -= 1;
            timerEl.textContent = `${timeLeft}ì´ˆ`;
            if(timeLeft <= 0) endGame();
        }

        function startGame(){
            active = true;
            score = 0;
            level = 1;
            timeLeft = 60;

            scoreEl.textContent = '0';
            levelEl.textContent = '1';
            timerEl.textContent = '60ì´ˆ';

            setEnabled(true);
            startBtn.disabled = true;

            hideOverlay(startOverlay);
            hideOverlay(endOverlay);

            nextQuestion(true);

            clearInterval(timerId);
            timerId = setInterval(tick, 1000);
        }

        function endGame(){
            active = false;
            setEnabled(false);
            startBtn.disabled = false;

            clearInterval(timerId);
            timerId = null;

            finalScoreEl.textContent = `ì ìˆ˜: ${score}`;
            showOverlay(endOverlay);
        }

        /*********************
         * Events
         *********************/
        startBtn.addEventListener('click', startGame);
        overlayStartBtn.addEventListener('click', startGame);
        restartBtn.addEventListener('click', startGame);

        submitBtn.addEventListener('click', check);
        newMapBtn.addEventListener('click', () => {
            if(!active) return;
            assignMapping();
            toast('ë§¤í•‘ì„ ìƒˆë¡œê³ ì¹¨ í–ˆì–´ìš”');
        });

        answerInput.addEventListener('keydown', (e) => {
            if(e.key === 'Enter') check();
        });

        // initial
        setEnabled(false);
        showOverlay(startOverlay);
        assignMapping();
        generateExpression();
    })();
</script>
</body>
</html>