<!doctype html>
<html lang="ko">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>êµ­ê°€ì½”ë“œ ê²€ìƒ‰ê¸° | ISO(Alpha-2/3), ìˆ«ìì½”ë“œ, ì§€ì—­(UN)</title>

    <!--
    https://restcountries.eu/
    https://api.first.org/v1/get-countries
    https://github.com/toddmotto/public-apis
    https://github.com/lukes/ISO-3166-Countries-with-Regional-Codes
    -->

    <meta name="description" content="ISO 3166-1 Alpha-2/3, ìˆ«ìì½”ë“œ, ISO 3166-2, UN ì§€ì—­/ê¶Œì—­ ì½”ë“œê¹Œì§€ ë¹ ë¥´ê²Œ ê²€ìƒ‰í•˜ì„¸ìš”." />
    <meta name="keywords" content="êµ­ê°€ì½”ë“œ, ISO 3166-1, alpha-2, alpha-3, numeric, ISO 3166-2, region, sub-region" />
    <meta name="robots" content="index,follow" />
    <meta name="theme-color" content="#ffffff" />

    <style>
        :root{
            --bg:#ffffff;
            --panel:#ffffff;
            --text:#0f172a;
            --muted:#64748b;
            --border:#e5e7eb;
            --shadow: 0 10px 30px rgba(2,6,23,.06);
            --shadow2: 0 6px 18px rgba(2,6,23,.06);
            --primary:#2563eb;
            --primary2:#1d4ed8;
            --ok:#16a34a;
            --radius:16px;
            --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
            --sans: ui-sans-serif, system-ui, -apple-system, "Apple SD Gothic Neo", "Malgun Gothic", "Segoe UI", Roboto, Arial, sans-serif;
        }
        *{ box-sizing:border-box; }
        body{
            margin:0;
            font-family: var(--sans);
            background: var(--bg);
            color: var(--text);
            line-height: 1.5;
        }
        .wrap{
            max-width: 1080px;
            margin: 0 auto;
            padding: 26px 18px 60px;
        }

        /* Header */
        .hero{ margin-bottom: 14px; }
        .title{
            font-size: 26px;
            letter-spacing:-.02em;
            margin:0;
        }
        .subtitle{
            margin:10px 0 0;
            color: var(--muted);
            max-width: 860px;
        }
        .badges{
            display:flex;
            flex-wrap:wrap;
            gap:8px;
            margin-top: 12px;
        }
        .badge{
            display:inline-flex;
            align-items:center;
            gap:8px;
            padding: 8px 10px;
            border:1px solid var(--border);
            border-radius: 999px;
            background:#fff;
            box-shadow: var(--shadow2);
            color: var(--muted);
            font-size: 12px;
            white-space: nowrap;
        }
        .dot{ width:8px;height:8px;border-radius:99px;background:var(--ok); }

        /* Panel */
        .panel{
            border:1px solid var(--border);
            border-radius: var(--radius);
            background:#fff;
            box-shadow: var(--shadow);
            padding: 16px;
        }
        .row{
            display:grid;
            grid-template-columns: 1fr auto;
            gap:10px;
            align-items:start;
        }
        @media (max-width: 720px){
            .row{ grid-template-columns: 1fr; }
        }
        .inputWrap{ position:relative; }
        .label{
            display:flex;
            justify-content:space-between;
            gap:10px;
            margin: 0 0 8px;
            font-size: 13px;
            color: var(--muted);
        }
        .helpTiny{ font-size:12px; color: var(--muted); opacity:.95; }

        input[type="text"]{
            width:100%;
            padding: 14px 14px;
            border: 1px solid var(--border);
            border-radius: 14px;
            outline:none;
            font-size: 16px;
            background:#fff;
            transition: box-shadow .15s, border-color .15s;
        }
        input[type="text"]:focus{
            border-color: rgba(37,99,235,.45);
            box-shadow: 0 0 0 4px rgba(37,99,235,.10);
        }

        .btns{ display:flex; gap:10px; justify-content:flex-end; flex-wrap:wrap; }
        .btn{
            cursor:pointer;
            border:1px solid var(--border);
            background:#fff;
            color: var(--text);
            border-radius: 14px;
            padding: 12px 14px;
            font-size: 14px;
            box-shadow: var(--shadow2);
            user-select:none;
            transition: transform .05s ease, box-shadow .15s, border-color .15s;
        }
        .btn:hover{ border-color: rgba(2,6,23,.16); }
        .btn:active{ transform: translateY(1px); }
        .btnPrimary{
            border-color: rgba(37,99,235,.25);
            background: linear-gradient(180deg, rgba(37,99,235,.95), rgba(29,78,216,.95));
            color:#fff;
        }
        .btnPrimary:hover{
            border-color: rgba(37,99,235,.40);
            box-shadow: 0 10px 24px rgba(37,99,235,.18);
        }

        /* Autocomplete */
        .ac{
            position:absolute;
            z-index: 30;
            left:0; right:0;
            margin-top: 8px;
            border:1px solid var(--border);
            background:#fff;
            border-radius: 14px;
            box-shadow: var(--shadow);
            overflow:hidden;
            display:none;
        }
        .acHeader{
            padding: 10px 12px;
            border-bottom:1px solid var(--border);
            color: var(--muted);
            font-size: 12px;
            background:#fafafa;
            display:flex;
            justify-content:space-between;
            gap:12px;
        }
        .acList{ max-height: 320px; overflow:auto; }
        .acItem{
            padding: 10px 12px;
            cursor:pointer;
            display:flex;
            align-items:center;
            justify-content:space-between;
            gap:12px;
        }
        .acItem:hover{ background:#f8fafc; }
        .acLeft{ display:flex; flex-direction:column; gap:2px; min-width:0; }
        .acTitle{ font-weight:700; font-size:14px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
        .acSub{ color:var(--muted); font-size:12px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
        .pill{
            font-family: var(--mono);
            font-size: 12px;
            padding: 4px 8px;
            border:1px solid var(--border);
            border-radius:999px;
            color: var(--muted);
            background:#fff;
            flex-shrink:0;
        }

        /* Meta bar */
        .metaBar{
            margin-top: 14px;
            display:flex;
            justify-content:space-between;
            align-items:center;
            gap:10px;
            flex-wrap:wrap;
            color: var(--muted);
            font-size: 13px;
        }
        .count{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
        .count strong{ color: var(--text); }
        .hint{ color: var(--muted); font-size: 12px; }

        /* Results */
        .grid{
            margin-top: 12px;
            display:grid;
            grid-template-columns: repeat(12, 1fr);
            gap: 12px;
        }
        .card{
            grid-column: span 12;
            border:1px solid var(--border);
            border-radius: var(--radius);
            background:#fff;
            box-shadow: var(--shadow2);
            overflow:hidden;
        }
        .cardTop{
            padding: 14px 14px 10px;
            border-bottom:1px solid var(--border);
            display:flex;
            justify-content:space-between;
            gap: 10px;
            flex-wrap:wrap;
            align-items:flex-start;
        }
        .cardTitle{
            margin:0;
            font-size: 16px;
            letter-spacing:-.01em;
        }
        .codes{ display:flex; flex-wrap:wrap; gap:6px; align-items:center; }
        .code{
            font-family: var(--mono);
            font-size: 12px;
            padding: 6px 10px;
            border-radius: 999px;
            border:1px solid var(--border);
            background:#fff;
            color: var(--text);
        }
        .code b{ color: var(--primary2); }
        .cardBody{ padding: 12px 14px 14px; }

        .kv{
            display:grid;
            grid-template-columns: 180px 1fr;
            gap: 10px 14px;
            padding: 8px 0;
            border-bottom:1px dashed #eef2f7;
        }
        .kv:last-child{ border-bottom:none; }
        .k{ color: var(--muted); font-size: 13px; min-height: 22px; }
        .v{ font-size: 14px; color: var(--text); min-height: 22px; word-break: break-word; }
        .mono{ font-family: var(--mono); }
        @media (max-width: 720px){
            .kv{ grid-template-columns: 1fr; }
            .k{ font-size:12px; }
            .v{ font-size:14px; }
        }

        .footer{
            margin-top: 20px;
            color: var(--muted);
            font-size: 12px;
        }

        .toast{
            position: fixed;
            left: 50%;
            bottom: 18px;
            transform: translateX(-50%);
            padding: 10px 12px;
            border:1px solid var(--border);
            border-radius: 999px;
            box-shadow: var(--shadow);
            background:#fff;
            color: var(--text);
            font-size: 13px;
            display:none;
            z-index: 50;
        }
    </style>
</head>

<body>
<main class="wrap">
    <header class="hero">
        <h1 class="title">êµ­ê°€ì½”ë“œ ê²€ìƒ‰ê¸° <span style="color:var(--muted);font-weight:700;">| ISO Â· ìˆ«ìì½”ë“œ Â· ì§€ì—­(UN)</span></h1>
        <p class="subtitle">
            êµ­ê°€ëª…(ì˜ë¬¸), <b>Alpha-2/Alpha-3</b>, <b>Numeric</b>, <b>ISO 3166-2</b>,
            <b>Region/Sub-region</b> ë“± ì–´ë–¤ ê°’ìœ¼ë¡œë„ ì¦‰ì‹œ ê²€ìƒ‰ë©ë‹ˆë‹¤.
        </p>
        <div class="badges">
            <span class="badge"><span class="dot"></span> ìˆœìˆ˜ HTML/CSS/JS</span>
            <span class="badge">âš¡ JSON ë¡œë“œ + ë¹ ë¥¸ ê²€ìƒ‰</span>
            <span class="badge">ğŸ” ì½”ë“œ/ì´ë¦„/ìˆ«ì/ì§€ì—­ í†µí•© ê²€ìƒ‰</span>
            <span class="badge">ğŸ§  ìë™ì™„ì„±</span>
        </div>
    </header>

    <section class="panel">
        <div class="row">
            <div class="inputWrap">
                <div class="label">
                    <span>ê²€ìƒ‰ì–´</span>
                    <span class="helpTiny">ì˜ˆ) KR / KOR / 410 / Japan / ISO 3166-2:KR / Asia / Eastern Europe</span>
                </div>
                <input id="q" type="text" inputmode="search" autocomplete="off" spellcheck="false"
                       placeholder="êµ­ê°€ëª…, Alpha-2/3, ìˆ«ìì½”ë“œ, ì§€ì—­ëª…, ISO 3166-2 ë“± ì…ë ¥" />
                <div id="ac" class="ac" aria-label="ìë™ì™„ì„±">
                    <div class="acHeader">
                        <span>ìë™ì™„ì„±</span>
                        <span id="acMeta">0ê°œ</span>
                    </div>
                    <div id="acList" class="acList"></div>
                </div>
            </div>

            <div class="btns">
                <button id="btnClear" class="btn" type="button">ì´ˆê¸°í™”</button>
                <button id="btnCopyTop" class="btn btnPrimary" type="button">ìƒë‹¨ ê²°ê³¼ ë³µì‚¬</button>
            </div>
        </div>

        <div class="metaBar">
            <div class="count">
                <span>ë°ì´í„°: <strong id="total">0</strong>ê°œ</span>
                <span class="hint">â€» ì§€ê¸ˆ ì£¼ì‹  JSON(í•˜ì´í”ˆ í‚¤)ì„ ê·¸ëŒ€ë¡œ ì§€ì›í•©ë‹ˆë‹¤.</span>
            </div>
            <div class="hint" id="status">ë¡œë”© ì¤‘â€¦</div>
        </div>
    </section>

    <section class="grid" id="grid" aria-live="polite"></section>

    <p class="footer">
        âš™ï¸ ê°™ì€ í´ë”ì— <span class="mono">countries-248.min.json</span> íŒŒì¼ì„ ë‘ì„¸ìš”.
        (ë¡œì»¬ì—ì„œ ë”ë¸”í´ë¦­ ì‹¤í–‰ ì‹œ fetchê°€ ë§‰íˆë©´ ê°„ë‹¨í•œ ë¡œì»¬ ì„œë²„ì—ì„œ ì‹¤í–‰í•˜ì„¸ìš”.)
    </p>
</main>

<div id="toast" class="toast"></div>

<script>
    const $ = (sel) => document.querySelector(sel);

    const q = $("#q");
    const grid = $("#grid");
    const totalEl = $("#total");
    const statusEl = $("#status");
    const toastEl = $("#toast");

    const ac = $("#ac");
    const acList = $("#acList");
    const acMeta = $("#acMeta");

    let DATA = [];
    let INDEX = []; // {id, ref, text}
    let lastResults = [];
    let acActiveIndex = -1;
    let acItems = [];

    function toast(msg){
        toastEl.textContent = msg;
        toastEl.style.display = "block";
        clearTimeout(toast._t);
        toast._t = setTimeout(()=> toastEl.style.display = "none", 1400);
    }

    function escapeHtml(str){
        return String(str ?? "")
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    function norm(s){
        if (s == null) return "";
        return String(s)
        .toLowerCase()
        .trim()
        .replace(/\s+/g, " ")
        .replace(/[\u2000-\u206F\u2E00-\u2E7F'â€™"â€œâ€`~!@#$%^&*()_=+\[\]{}\\|;:,.<>/?-]/g, " ");
    }

    function digitsOnly(s){
        return String(s || "").replace(/\D/g, "");
    }

    function pick(obj, keys){
        for (const k of keys){
            const v = obj?.[k];
            if (v !== undefined && v !== null && String(v).trim() !== "") return v;
        }
        return "";
    }

    // âœ… í•˜ì´í”ˆ í‚¤ JSON -> ë‚´ë¶€ í‘œì¤€ í•„ë“œë¡œ ì •ê·œí™”
    function normalizeRow(r){
        const name_en = pick(r, ["name"]);
        const iso2 = pick(r, ["alpha-2"]);
        const iso3 = pick(r, ["alpha-3"]);
        const iso_numeric = String(pick(r, ["country-code"]) || "").padStart(3, "0");
        const iso_3166_2 = pick(r, ["iso_3166-2"]);

        const region = pick(r, ["region"]);
        const sub_region = pick(r, ["sub-region"]);
        const intermediate_region = pick(r, ["intermediate-region"]);

        const region_code = pick(r, ["region-code"]);
        const sub_region_code = pick(r, ["sub-region-code"]);
        const intermediate_region_code = pick(r, ["intermediate-region-code"]);

        const aliases = [];
        if (name_en) aliases.push(name_en);
        if (iso2) aliases.push(iso2);
        if (iso3) aliases.push(iso3);
        if (iso_numeric) aliases.push(iso_numeric);
        if (iso_3166_2) aliases.push(iso_3166_2);
        if (region) aliases.push(region);
        if (sub_region) aliases.push(sub_region);
        if (intermediate_region) aliases.push(intermediate_region);

        return {
            // Display
            name_ko: "",
            name_en,

            // ISO
            iso2,
            iso3,
            iso_numeric,
            un_m49: iso_numeric,
            iso_3166_2,

            // UN Region classification
            region,
            sub_region,
            intermediate_region,
            region_code,
            sub_region_code,
            intermediate_region_code,

            // (ì¶”í›„ í™•ì¥ìš©: í˜„ì¬ ì›ë³¸ì— ì—†ìŒ)
            calling_code: "",
            currency_code: "",
            capital_ko: "",
            capital_en: "",
            cctld: "",
            mcc: "",
            gs1: "",
            wipo: "",
            vehicle_reg: "",
            aircraft_reg_prefix: "",
            icao_prefix: "",
            ioc: "",
            fifa: "",

            aliases
        };
    }

    function buildIndex(rows){
        INDEX = rows.map((r, i) => {
            const parts = [];
            parts.push(r.name_ko, r.name_en);
            if (Array.isArray(r.aliases)) parts.push(...r.aliases);

            // í•µì‹¬ ì½”ë“œ/í•„ë“œ
            parts.push(r.iso2, r.iso3, r.iso_numeric, r.un_m49, r.iso_3166_2);
            parts.push(r.region, r.sub_region, r.intermediate_region);
            parts.push(r.region_code, r.sub_region_code, r.intermediate_region_code);

            const text = norm(parts.filter(Boolean).join(" | "));
            return { id:i, ref:r, text };
        });
    }

    function scoreMatch(hay, query){
        if (!query) return 0;
        let s = 0;
        const idx = hay.indexOf(query);
        if (idx === -1) return 0;

        s += 50;
        if (idx === 0) s += 30;

        if (query.length <= 2) s -= 10;
        if (/^[a-z]{2,3}$/.test(query)) s += 20;
        if (/^\d{3}$/.test(query)) s += 20;

        return s;
    }

    function search(query, limit=50){
        const rawQ = String(query || "").trim();
        const nq = norm(rawQ);
        if (!nq) return INDEX.slice(0, limit).map(x=>x.ref);

        const qDigits = digitsOnly(rawQ);

        const scored = [];
        for (const it of INDEX){
            let s = scoreMatch(it.text, nq);

            const r = it.ref;
            const up = rawQ.toUpperCase();

            // ê°•í•œ ìš°ì„ ìˆœìœ„ (ISO2/3 ì •í™• ì¼ì¹˜)
            if (up && (r.iso2 === up || r.iso3 === up)) s += 50;

            // ìˆ«ìì½”ë“œ ì •í™• ì¼ì¹˜(004, 410 ë“±)
            if (qDigits && String(r.iso_numeric) === String(qDigits).padStart(3,"0")) s += 35;

            // ISO 3166-2 ê°’ ì •í™• í¬í•¨
            if (rawQ && r.iso_3166_2 && r.iso_3166_2.toLowerCase().includes(rawQ.toLowerCase())) s += 15;

            if (s > 0) scored.push([s, r]);
        }

        scored.sort((a,b)=> b[0]-a[0]);
        return scored.slice(0, limit).map(x=>x[1]);
    }

    function kv(k, v){
        return `
        <div class="kv">
          <div class="k">${escapeHtml(k)}</div>
          <div class="v">${v || '<span style="color:var(--muted);">-</span>'}</div>
        </div>
      `;
    }

    function renderResults(rows){
        lastResults = rows;

        if (!rows.length){
            grid.innerHTML = `
          <div class="card">
            <div class="cardBody">
              <b>ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</b>
              <div class="hint" style="margin-top:6px;">
                ì˜ˆ) KR / KOR / 410 / Japan / ISO 3166-2:KR / Asia / Eastern Europe
              </div>
            </div>
          </div>
        `;
            return;
        }

        grid.innerHTML = rows.map(r => {
            const title = r.name_ko || r.name_en || "(unknown)";
            const codes = [
                r.iso2 ? `<span class="code">A2 <b>${escapeHtml(r.iso2)}</b></span>` : "",
                r.iso3 ? `<span class="code">A3 <b>${escapeHtml(r.iso3)}</b></span>` : "",
                r.iso_numeric ? `<span class="code">NUM <b>${escapeHtml(r.iso_numeric)}</b></span>` : "",
                r.iso_3166_2 ? `<span class="code">ISO-2 <b>${escapeHtml(r.iso_3166_2.replace("ISO 3166-2:",""))}</b></span>` : ""
            ].filter(Boolean).join("");

            const regionLine = [r.region, r.sub_region, r.intermediate_region].filter(Boolean).join(" Â· ");
            const regionCodes = [
                r.region_code ? `Region: <span class="mono">${escapeHtml(r.region_code)}</span>` : "",
                r.sub_region_code ? `Sub: <span class="mono">${escapeHtml(r.sub_region_code)}</span>` : "",
                r.intermediate_region_code ? `Inter: <span class="mono">${escapeHtml(r.intermediate_region_code)}</span>` : ""
            ].filter(Boolean).join(" Â· ");

            return `
          <article class="card">
            <div class="cardTop">
              <div>
                <h3 class="cardTitle">${escapeHtml(title)}</h3>
                <div class="hint" style="margin-top:4px;">
                  ${r.name_en ? escapeHtml(r.name_en) : ""}
                </div>
              </div>
              <div class="codes">${codes}</div>
            </div>
            <div class="cardBody">
              ${kv("ISO 3166-1", [
                r.iso2 ? `Alpha-2: <span class="mono">${escapeHtml(r.iso2)}</span>` : "",
                r.iso3 ? `Alpha-3: <span class="mono">${escapeHtml(r.iso3)}</span>` : "",
                r.iso_numeric ? `Numeric: <span class="mono">${escapeHtml(r.iso_numeric)}</span>` : ""
            ].filter(Boolean).join(" Â· "))}
              ${kv("ISO 3166-2", r.iso_3166_2 ? `<span class="mono">${escapeHtml(r.iso_3166_2)}</span>` : "")}
              ${kv("UN ì§€ì—­ ë¶„ë¥˜", regionLine ? escapeHtml(regionLine) : "")}
              ${kv("UN ì§€ì—­ ì½”ë“œ", regionCodes ? regionCodes : "")}
            </div>
          </article>
        `;
        }).join("");
    }

    function closeAC(){
        ac.style.display = "none";
        acItems = [];
        acActiveIndex = -1;
    }

    function openAC(items){
        acItems = items;
        acActiveIndex = -1;

        acMeta.textContent = `${items.length}ê°œ`;
        acList.innerHTML = items.map((r, idx) => {
            const title = r.name_ko || r.name_en || "(unknown)";
            const sub = [
                r.iso2 ? r.iso2 : "",
                r.iso3 ? r.iso3 : "",
                r.iso_numeric ? r.iso_numeric : "",
                r.region ? r.region : ""
            ].filter(Boolean).join(" Â· ");

            return `
          <div class="acItem" role="option" data-idx="${idx}">
            <div class="acLeft">
              <div class="acTitle">${escapeHtml(title)}</div>
              <div class="acSub">${escapeHtml(sub)}</div>
            </div>
            <div style="display:flex;gap:6px;align-items:center;">
              ${r.iso2 ? `<span class="pill">${escapeHtml(r.iso2)}</span>` : ""}
              ${r.iso3 ? `<span class="pill">${escapeHtml(r.iso3)}</span>` : ""}
            </div>
          </div>
        `;
        }).join("");

        ac.style.display = items.length ? "block" : "none";
    }

    function pickAC(index){
        const r = acItems[index];
        if (!r) return;
        q.value = r.name_ko || r.name_en || "";
        closeAC();
        renderResults(search(q.value, 50));
    }

    function debounce(fn, ms){
        let t;
        return (...args) => {
            clearTimeout(t);
            t = setTimeout(()=> fn(...args), ms);
        };
    }

    const onInput = debounce(() => {
        const query = q.value.trim();
        const results = search(query, 50);
        renderResults(results);

        const acResults = query ? search(query, 8) : [];
        if (query && acResults.length) openAC(acResults);
        else closeAC();
    }, 120);

    function copyTopResult(){
        if (!lastResults.length){
            toast("ë³µì‚¬í•  ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.");
            return;
        }
        const r = lastResults[0];
        const lines = [
            `Name: ${r.name_en || ""}`,
            `Alpha-2: ${r.iso2 || ""}`,
            `Alpha-3: ${r.iso3 || ""}`,
            `Numeric: ${r.iso_numeric || ""}`,
            `ISO 3166-2: ${r.iso_3166_2 || ""}`,
            `Region: ${r.region || ""}`,
            `Sub-region: ${r.sub_region || ""}`,
            `Intermediate-region: ${r.intermediate_region || ""}`,
            `Region-code: ${r.region_code || ""}`,
            `Sub-region-code: ${r.sub_region_code || ""}`,
            `Intermediate-region-code: ${r.intermediate_region_code || ""}`
        ].join("\n");

        navigator.clipboard.writeText(lines)
        .then(()=> toast("ìƒë‹¨ ê²°ê³¼ë¥¼ ë³µì‚¬í–ˆìŠµë‹ˆë‹¤."))
        .catch(()=> {
            const ta = document.createElement("textarea");
            ta.value = lines;
            document.body.appendChild(ta);
            ta.select();
            try { document.execCommand("copy"); toast("ìƒë‹¨ ê²°ê³¼ë¥¼ ë³µì‚¬í–ˆìŠµë‹ˆë‹¤."); }
            catch(e){ toast("ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."); }
            document.body.removeChild(ta);
        });
    }

    // ìƒ˜í”Œ(ë¡œë“œ ì‹¤íŒ¨ ëŒ€ë¹„)
    const SAMPLE_RAW = [
        {"name":"Korea, Republic of","alpha-2":"KR","alpha-3":"KOR","country-code":"410","iso_3166-2":"ISO 3166-2:KR","region":"Asia","sub-region":"Eastern Asia","intermediate-region":"","region-code":"142","sub-region-code":"030","intermediate-region-code":""},
        {"name":"United States of America","alpha-2":"US","alpha-3":"USA","country-code":"840","iso_3166-2":"ISO 3166-2:US","region":"Americas","sub-region":"Northern America","intermediate-region":"","region-code":"019","sub-region-code":"021","intermediate-region-code":""},
        {"name":"Japan","alpha-2":"JP","alpha-3":"JPN","country-code":"392","iso_3166-2":"ISO 3166-2:JP","region":"Asia","sub-region":"Eastern Asia","intermediate-region":"","region-code":"142","sub-region-code":"030","intermediate-region-code":""}
    ];

    async function loadData(){
        statusEl.textContent = "ë°ì´í„° ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘â€¦";
        try{
            const res = await fetch("assets/json/countries-248.min.json", { cache: "no-store" });
            if (!res.ok) throw new Error("HTTP " + res.status);
            const raw = await res.json();
            if (!Array.isArray(raw)) throw new Error("JSON is not an array");
            DATA = raw.map(normalizeRow);
            statusEl.textContent = "ë°ì´í„° ë¡œë“œ ì™„ë£Œ";
        }catch(e){
            DATA = SAMPLE_RAW.map(normalizeRow);
            statusEl.textContent = "ìƒ˜í”Œ ë°ì´í„°ë¡œ ì‹¤í–‰ ì¤‘ (countries-248.min.json ë¡œë“œ ì‹¤íŒ¨)";
        }

        totalEl.textContent = String(DATA.length);
        buildIndex(DATA);
        renderResults(search("", 30));
    }

    // Events
    q.addEventListener("input", onInput);

    q.addEventListener("keydown", (e) => {
        if (ac.style.display !== "block") return;

        const items = Array.from(acList.querySelectorAll(".acItem"));
        if (!items.length) return;

        if (e.key === "ArrowDown"){
            e.preventDefault();
            acActiveIndex = Math.min(acActiveIndex + 1, items.length - 1);
        }else if (e.key === "ArrowUp"){
            e.preventDefault();
            acActiveIndex = Math.max(acActiveIndex - 1, 0);
        }else if (e.key === "Enter"){
            if (acActiveIndex >= 0){
                e.preventDefault();
                pickAC(acActiveIndex);
            }
        }else if (e.key === "Escape"){
            closeAC();
        }else{
            return;
        }

        items.forEach((el, idx) => {
            el.style.background = (idx === acActiveIndex) ? "#f1f5f9" : "";
        });

        const active = items[acActiveIndex];
        if (active) active.scrollIntoView({ block: "nearest" });
    });

    acList.addEventListener("click", (e) => {
        const item = e.target.closest(".acItem");
        if (!item) return;
        const idx = Number(item.dataset.idx);
        pickAC(idx);
    });

    document.addEventListener("click", (e) => {
        if (!e.target.closest(".inputWrap")) closeAC();
    });

    $("#btnClear").addEventListener("click", () => {
        q.value = "";
        closeAC();
        renderResults(search("", 30));
        q.focus();
        toast("ì´ˆê¸°í™”í–ˆìŠµë‹ˆë‹¤.");
    });

    $("#btnCopyTop").addEventListener("click", copyTopResult);

    loadData();
</script>
</body>
</html>
